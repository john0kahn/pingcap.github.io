<!DOCTYPE html>
<html lang="en"><head>
<meta name="robots" content="noindex"><meta charset="utf-8"/><meta content="IE=edge" http-equiv="X-UA-Compatible"/><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"/>
<script>
window.ga =
    window.ga ||
    function() {
        ;(ga.q = ga.q || []).push(arguments)
    }
ga.l = +new Date()
ga('create', 'UA-99991864-4', 'auto')
ga('send', 'pageview')
</script>
<script async="" src="https://download.pingcap.com/js/ga-analytics.js"></script>
<style media="screen" type="text/css">
        .st_tree {
            display: none;
        }
    </style>
<link href="https://download.pingcap.com/style/github-markdown.css" rel="stylesheet"/>
<link href="/css/doc.css" rel="stylesheet"/>
<title>使用 TiUP 部署 TiDB 集群 | TiDB 官方用户文档</title><link href="/images/favicon.ico" rel="icon" type="image/x-icon"/>
<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<link href="/images/apple-touch-icon.png" rel="apple-touch-icon"/>
<meta content="TiDB 是由 PingCAP 研发的一款定位于在线事务处理/在线分析处理（HTAP）的开源融合型数据库产品，实现了一键水平伸缩，强一致性的多副本数据安全，分布式事务，实时 OLAP 等重要特性，目前已广泛应用于金融服务、互联网、制造等行业。" name="description"/>
<meta content="noodp" name="robots"/>
<meta content="TiDB, MySQL, HTAP, Open Source, Cloud-Native, NewSQL, Aurora Alternative" name="keywords"/>
<meta content="en_US" property="og:locale"/>
<meta content="website" property="og:type"/>
<meta content="使用 TiUP 部署 TiDB 集群 | TiDB 官方用户文档" property="og:title"/>
<meta content="TiDB 是由 PingCAP 研发的一款定位于在线事务处理/在线分析处理（HTAP）的开源融合型数据库产品，实现了一键水平伸缩，强一致性的多副本数据安全，分布式事务，实时 OLAP 等重要特性，目前已广泛应用于金融服务、互联网、制造等行业。" property="og:description"/>
<meta content="https://pingcap.com/docs-cn/stable/how-to/deploy/orchestrated/tiup/" property="og:url"/>
<meta content="MySQL at Scale. No more manual sharding" property="og:site_name"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" property="og:image"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" property="og:image:secure_url"/><meta content="summary" name="twitter:card"/><meta content="TiDB 是由 PingCAP 研发的一款定位于在线事务处理/在线分析处理（HTAP）的开源融合型数据库产品，实现了一键水平伸缩，强一致性的多副本数据安全，分布式事务，实时 OLAP 等重要特性，目前已广泛应用于金融服务、互联网、制造等行业。" name="twitter:description"/>
<meta content="使用 TiUP 部署 TiDB 集群 | TiDB 官方用户文档" name="twitter:title"/>
<meta content="@pingcap" name="twitter:site"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" name="twitter:image"/>
<meta content="@pingcap" name="twitter:creator"/>
<script type="application/ld+json">
{
    "@context": "http:\/\/schema.org",
    "@type": "WebSite",
    "url": "https:\/\/pingcap.com\/",
    "name": "PingCAP",
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https:\/\/pingcap.com\/?s={search_term_string}",
        "query-input": "required name=search_term_string"
    }
}
</script>
<script>
    (function(){
        var bp = document.createElement('script');
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.woff" rel="preload" type="font/woff"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.ttf" rel="preload" type="font/ttf"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.woff" rel="preload" type="font/woff"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.ttf" rel="preload" type="font/ttf"/>
<link as="script" href="https://download.pingcap.com/js/jquery.min.js" rel="preload"/>
<link href="/css/main.css" rel="stylesheet"/>
<link href="https://download.pingcap.com/style/docsearch.min.css" rel="stylesheet"/>
<script type="text/javascript">
var trackOutboundLink = function(url) {
  var redirectTriggered = false
  ga('send', 'event', 'outbound', 'click', url, {
    hitCallback: function() {
      redirectTriggered = true
      document.location = url
    }
  })
  setTimeout(function() {
    if (!redirectTriggered) {
      document.location = url
    }
  }, 1500)
}

var trackViews = function(btn_type, event_category) {
  var event_label = btn_type
  var eventCategory = event_category
  ga('send', 'event', {
    'eventCategory': eventCategory,
    'eventAction': 'click',
    'eventLabel': event_label
  });
}
</script>
<script>if (location.pathname === '/') {
        if (location.hostname === 'pingcap.github.io') {
            location.href = '/en/'
        }
    }</script></head> <body data-lang="cn"><div id="page-content">
<header class="fixed-top" role="navigation">
<div class="container">
<a class="nav-brand" href="/index.html"><img alt="PingCAP" src="/images/pingcap-logo.png"/></a>
<div class="nav-wrapper">
<div class="navigation">
<ul>
<li><a class="nav-blinking" href="https://university.pingcap.com/" onclick="trackViews('navbar-university', 'pingcap-university_view')" target="_blank">PingCAP
                        University</a></li>
<li class="docs-type-selector sel" id="docsTypeSelector">
<a class="header-doc-nav" href="#">文档</a>
<div class="header-dropdown-menu" id="docsTypeSelectorItem">
<a class="header-dropdown-item" href="/docs-cn/stable/" onclick="trackViews('navbar-tidb-docs', 'docs-cn_view')">TiDB</a>
<a class="header-dropdown-item" href="/docs-cn/tidb-in-kubernetes/stable/" onclick="trackViews('navbar-operator-docs', 'docs-cn_view')">TiDB in Kubernetes</a>
<a class="header-dropdown-item" href="/docs-cn/tidb-data-migration/stable/" onclick="trackViews('navbar-dm-docs', 'docs-cn_view')">TiDB Data Migration (DM)</a>
</div>
</li>
<li><a href="/cases-cn">案例</a></li>
<li><a href="/community-cn">社区</a></li>
<li><a href="/blog-cn">博客</a></li>
<li><a href="/about-cn">关于</a></li>
<li><a href="https://asktug.com" onclick="trackViews('navbar-asktug', 'asktug_view')" target="_blank">问答</a></li>
<li><a class="link-download" href="mailto:info@pingcap.com" onclick="trackViews('navbar-contact-us', 'mail_to_info_view')" target="_blank">联系我们</a></li>
</ul>
</div>
<div class="global-search">
<form action="/search/docs-cn/stable/" class="search-wrapper">
<span class="icon-search"><svg fill="#fff" height="18" viewbox="0 0 67.125 67.125" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M23.902 0C11.01 0 .523 10.488.523 23.38c0 12.891 10.487 23.379 23.379 23.379a23.258 23.258 0 0 0 14.471-5.037l24.816 24.817c.391.391.902.586 1.414.586s1.023-.195 1.414-.586a2 2 0 0 0 0-2.828L41.293 38.985c3.721-4.142 5.989-9.613 5.989-15.605C47.282 10.488 36.794 0 23.902 0zM4.523 23.38C4.523 12.694 13.216 4 23.902 4c10.687 0 19.38 8.694 19.38 19.38 0 5.396-2.221 10.279-5.791 13.795a1.959 1.959 0 0 0-.488.349 2.003 2.003 0 0 0-.271.343C33.31 40.9 28.825 42.76 23.903 42.76c-10.686-.001-19.38-8.695-19.38-19.38z"></path><path d="M24.075 8.591c-8.25 0-14.962 6.712-14.962 14.962a2 2 0 0 0 4 0c0-6.044 4.918-10.962 10.962-10.962a2 2 0 0 0 0-4z"></path></svg></span>
<input data-lang="cn" data-type="" id="search-input" name="q" placeholder="搜索 TiDB 文档" type="search"/>
</form>
</div>
</div>
<div class="nav-btn nav-slider">
<i class="material-icons"><svg height="16" viewbox="0 0 459 459" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M0 382.5h459v-51H0v51zM0 255h459v-51H0v51zM0 76.5v51h459v-51H0z" fill="#FFF"></path></svg></i>
</div>
</div>
</header>
<nav class="mobile-sidebar">
<div class="nav-header">
<div class="logo-wrap">
<a class="nav-brand" href="/en"><img alt="PingCAP" src="/images/pingcap-logo.png"/></a>
</div>
</div>
<ul class="ul-base">
<li class="docs-type-selector sel" id="docsTypeSelector">
<p class="header-doc-nav">文档</p>
<div class="header-dropdown-menu" id="docsTypeSelectorItem">
<a class="header-dropdown-item" href="/docs-cn/stable/" onclick="trackViews('navbar-tidb-docs', 'docs-cn_view')">TiDB</a>
<a class="header-dropdown-item" href="/docs-cn/tidb-in-kubernetes/stable/" onclick="trackViews('navbar-operator-docs', 'docs-cn_view')">TiDB in Kubernetes</a>
<a class="header-dropdown-item" href="/docs-cn/tidb-data-migration/stable/" onclick="trackViews('navbar-dm-docs', 'docs-cn_view')">TiDB Data Migration (DM)</a>
</div>
</li>
<li><a href="/cases-cn">案例</a></li>
<li><a href="/community-cn">社区</a></li>
<li><a href="/blog-cn">博客</a></li>
<li><a href="/about-cn">关于</a></li>
<li><a href="https://asktug.com" onclick="trackViews('navbar-asktug', 'asktug_view')" target="_blank">问答</a></li>
<li><a class="link-download" href="mailto:info@pingcap.com" onclick="trackViews('navbar-contact-us', 'mail_to_info_view')" target="_blank">联系我们</a></li>
<li><a class="nav-blinking" href="https://university.pingcap.com/" onclick="trackViews('navbar-university', 'pingcap-university_view')" target="_blank">PingCAP University</a></li>
</ul>
<div class="nav-footer">
<div class="contact-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>Contact</strong></h4>
<ul class="social social-cn ul-base">
<li><a class="twitter" href="https://twitter.com/PingCAP" target="_blank"><svg height="18" viewbox="0 0 612 612" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M612 116.258a250.714 250.714 0 0 1-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 0 1-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a></li>
<li><a class="linkedin" href="https://www.linkedin.com/company/pingcap/" target="_blank"><svg height="18" viewbox="0 0 438.536 438.535" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M5.424 145.895H99.64v282.932H5.424zM408.842 171.739c-19.791-21.604-45.967-32.408-78.512-32.408-11.991 0-22.891 1.475-32.695 4.427-9.801 2.95-18.079 7.089-24.838 12.419-6.755 5.33-12.135 10.278-16.129 14.844-3.798 4.337-7.512 9.389-11.136 15.104v-40.232h-93.935l.288 13.706c.193 9.139.288 37.307.288 84.508 0 47.205-.19 108.777-.572 184.722h93.931V270.942c0-9.705 1.041-17.412 3.139-23.127 4-9.712 10.037-17.843 18.131-24.407 8.093-6.572 18.13-9.855 30.125-9.855 16.364 0 28.407 5.662 36.117 16.987 7.707 11.324 11.561 26.98 11.561 46.966V428.82h93.931V266.664c-.007-41.688-9.897-73.328-29.694-94.925zM53.103 9.708c-15.796 0-28.595 4.619-38.4 13.848C4.899 32.787 0 44.441 0 58.529 0 72.42 4.758 84.034 14.275 93.358c9.514 9.325 22.078 13.99 37.685 13.99h.571c15.99 0 28.887-4.661 38.688-13.99 9.801-9.324 14.606-20.934 14.417-34.829-.19-14.087-5.047-25.742-14.561-34.973C81.562 14.323 68.9 9.708 53.103 9.708z"></path></svg></a></li>
<li><a class="reddit" href="https://www.reddit.com/r/TiDB/" target="_blank"><svg height="18" viewbox="0 0 279.748 279.748" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M279.748 133.142c0-19.299-15.701-35-35-35-10.768 0-20.674 4.812-27.279 13.064-18.532-8.431-39.663-13.626-62.015-15.271l19.206-60.692 42.895 9.294c3.285 12.782 14.901 22.258 28.693 22.258 16.336 0 29.627-13.29 29.627-29.626 0-16.336-13.291-29.627-29.627-29.627-11.801 0-21.999 6.941-26.759 16.95l-49.497-10.725a10.002 10.002 0 0 0-11.651 6.756L134.636 95.43c-26.164.638-50.988 6.053-72.356 15.775-6.606-8.251-16.512-13.063-27.28-13.063-19.299 0-35 15.701-35 35 0 9.373 3.683 18.173 10.222 24.709-3.9 8.37-5.875 17.076-5.875 25.936 0 24.048 14.396 46.492 40.538 63.199 25.447 16.264 59.183 25.221 94.989 25.221 35.808 0 69.542-8.957 94.989-25.221 26.142-16.707 40.538-39.151 40.538-63.199 0-8.859-1.975-17.565-5.875-25.936 6.539-6.537 10.222-15.336 10.222-24.709zM15.369 145.139c-2.212-3.59-3.369-7.688-3.369-11.997 0-12.682 10.317-23 23-23 5.444 0 10.558 1.851 14.649 5.258-14.622 8.302-26.132 18.289-34.28 29.739zm52.671 20.266c0-13.785 11.215-25 25-25s25 11.215 25 25-11.215 25-25 25-25-11.215-25-25zm123.119 57.054c-9.745 10.637-29.396 17.244-51.285 17.244-21.888 0-41.539-6.607-51.284-17.244a9.937 9.937 0 0 1-2.617-7.192 9.933 9.933 0 0 1 3.235-6.937 9.974 9.974 0 0 1 6.754-2.627c2.797 0 5.484 1.183 7.373 3.244 5.803 6.333 20.827 10.756 36.539 10.756s30.737-4.423 36.539-10.756a10.022 10.022 0 0 1 7.374-3.244c2.508 0 4.906.933 6.755 2.627a9.928 9.928 0 0 1 3.234 6.937 9.933 9.933 0 0 1-2.617 7.192zm-4.451-32.054c-13.785 0-25-11.215-25-25s11.215-25 25-25 25 11.215 25 25-11.215 25-25 25zm77.671-45.266c-8.147-11.45-19.657-21.436-34.28-29.739 4.092-3.408 9.205-5.258 14.649-5.258 12.683 0 23 10.318 23 23 0 4.309-1.157 8.407-3.369 11.997z"></path></svg></a></li>
<li><a class="google-plus" href="https://groups.google.com/forum/#!forum/tidb-user" target="_blank"><svg height="18" viewbox="0 0 491.858 491.858" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M377.472 224.957H201.319v58.718H308.79c-16.032 51.048-63.714 88.077-120.055 88.077-69.492 0-125.823-56.335-125.823-125.824 0-69.492 56.333-125.823 125.823-125.823 34.994 0 66.645 14.289 89.452 37.346l42.622-46.328c-34.04-33.355-80.65-53.929-132.074-53.929C84.5 57.193 0 141.693 0 245.928s84.5 188.737 188.736 188.737c91.307 0 171.248-64.844 188.737-150.989v-58.718l-.001-.001zM491.858 224.857h-36.031v-36.031h-30.886v36.031H388.91v30.883h36.031v36.032h30.886V255.74h36.031z"></path></svg></a></li>
<li><a class="stack-overflow" href="https://stackoverflow.com/questions/tagged/tidb" target="_blank"><svg height="18" viewbox="0 0 547.597 547.597" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M140.81 475.111h.024l189.91-.269c8.434-.013 15.3-6.886 15.3-15.318v-21.298c0-8.428-6.854-15.288-15.3-15.288l-189.91.264c-8.433.012-15.3 6.885-15.3 15.318v21.31c.001 8.427 6.855 15.281 15.276 15.281z"></path><path d="M58.667 517.854c.073 29.26.073 29.449 3.072 29.449h.055l10.612.294h.086s85.814 0 171.629-.036c42.914-.019 85.821-.05 118-.092 16.09-.019 29.505-.043 38.887-.074 17.803-.055 17.803-.055 17.803-3.072l.3-10.697V333.299c0-8.434-6.866-15.3-15.3-15.3h-11.909c-8.434 0-15.3 6.866-15.3 15.3V496.22c0 5.062-4.119 9.18-9.181 9.18H110.51c-5.061 0-9.18-4.118-9.18-9.18V333.299c0-8.434-6.867-15.3-15.3-15.3H73.82c-8.433 0-15.3 6.86-15.3 15.3 0 23.342.012 76.084.055 122.981.019 23.447.05 45.442.092 61.574z"></path><path d="M142.322 397.399l189.402 17.467c.478.043.948.062 1.413.062 7.956 0 14.468-5.985 15.159-13.917l1.83-21.096c.729-8.396-5.508-15.851-13.898-16.628l-189.102-17.461c-8.593-.795-15.869 5.441-16.653 13.825l-1.97 21.108a15.172 15.172 0 0 0 3.452 11.181 15.19 15.19 0 0 0 10.367 5.459zM437.636 208.849a15.253 15.253 0 0 0 17.694 12.443l21.065-3.678c8.311-1.451 13.898-9.395 12.454-17.706l-32.504-187.23c-1.42-8.207-9.21-13.917-17.692-12.448l-21.065 3.678c-8.311 1.451-13.898 9.395-12.454 17.705l32.502 187.236zM190.333 194.375l163.6 96.708a15.28 15.28 0 0 0 7.778 2.136c5.393 0 10.447-2.876 13.183-7.509l10.876-18.36c2.08-3.519 2.674-7.631 1.658-11.591a15.18 15.18 0 0 0-7.032-9.358l-163.6-96.714c-7.014-4.149-16.836-1.597-20.967 5.374l-10.869 18.36a15.2 15.2 0 0 0-1.658 11.591 15.21 15.21 0 0 0 7.031 9.363zM387.525 240.501a15.276 15.276 0 0 0 12.626 6.659c3.091 0 6.077-.924 8.635-2.681l17.405-11.934c6.953-4.768 8.752-14.314 4.015-21.292L323.29 54.104c-4.584-6.732-14.498-8.623-21.236-3.984l-17.737 12.21c-6.945 4.779-8.727 14.327-3.971 21.291l107.179 156.88zM154.482 302.319l183.465 49.156c1.298.349 2.632.526 3.966.526 6.903 0 12.98-4.67 14.762-11.347l5.508-20.624c2.179-8.152-2.681-16.555-10.826-18.74l-183.465-49.162c-8.017-2.148-16.604 2.852-18.728 10.826l-5.508 20.63c-2.179 8.142 2.68 16.551 10.826 18.735z"></path></svg></a></li>
<li id="wechat-mobile"><a class="wechat" href="javascript:void(0)"><svg height="18" viewbox="0 0 31.403 31.404" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M31.403 21.306c0-4.597-4.388-8.32-9.8-8.32-5.414 0-9.802 3.725-9.802 8.32 0 4.597 4.388 8.322 9.802 8.322 1.701 0 3.302-.369 4.697-1.019l3.863 1.671-.447-4.309c1.066-1.329 1.687-2.937 1.687-4.665zm-13.102-2.254a1.395 1.395 0 1 1 0-2.79 1.395 1.395 0 0 1 0 2.79zm6.604 0a1.395 1.395 0 1 1 .003-2.79 1.395 1.395 0 0 1-.003 2.79z"></path><path d="M21.604 11.885c1.515 0 2.957.27 4.271.755.009-.175.03-.345.03-.521 0-6.074-5.801-10.996-12.953-10.996C5.799 1.123 0 6.044 0 12.119c0 2.284.822 4.408 2.229 6.167l-.591 5.694 5.104-2.213c1.264.59 2.661.986 4.136 1.189a8.143 8.143 0 0 1-.179-1.65c.001-5.195 4.892-9.421 10.905-9.421zm-4.287-6.428a1.84 1.84 0 1 1-1.841 1.84c0-1.016.825-1.84 1.841-1.84zM8.586 9.139a1.84 1.84 0 0 1 0-3.682 1.84 1.84 0 1 1 0 3.682z"></path></svg></a><div class="qr_code_outer f-hide f-tc">
<div class="qr_code">
<i id="close_qrcode"><svg viewbox="0 0 224.512 224.512" xmlns="http://www.w3.org/2000/svg"><path d="M224.507 6.997L217.521 0 112.256 105.258 6.998 0 .005 6.997l105.258 105.257L.005 217.512l6.993 7L112.256 119.24l105.265 105.272 6.986-7-105.258-105.258z" fill="#010002"></path></svg></i>
<img alt="Wechat qrCode" class="qr_code_img" id="js_qr_code_img" src="/images/wechat-qrcode.jpg"/>
<p>微信扫一扫<br/> 微信ID：pingcap2015</p>
</div>
</div>
</li>
</ul>
</div>
<div class="subscribe" id="subscribe-mobile"></div>
</div>
<div class="container">
<a class="btn-lang" href="/docs/" id="lang">English</a>
</div>
</div>
</nav>
<div class="live-poster-mobile"><a href="http://t.cn/A6Pgdo1D" target="_blank"><img class="lazy" src="/images/live-poster-mobile.jpg"/></a></div>
<div class="doc">
<div class="container">
<div class="sidebar">
<div class="sticky-sidebar docs-sticky-sidebar">
<div class="title"> TiDB 文档 </div>
<div class="version-switcher">
<button id="dropdownMenuButton" type="button">v4.0-rc</button>
<div class="dropdown-menu visibility-hide" id="dropdown-menu-items">
<a class="dropdown-item " href="
                /docs-cn/stable/how-to/deploy/orchestrated/tiup/">v4.0-rc (stable)</a>
<a class="dropdown-item " href="
                /docs-cn/dev/how-to/deploy/orchestrated/tiup/">dev</a>
<a class="dropdown-item unclickable-btn" href="
                #">v3.1-rc<span class="tooltiptext">This doc does not exist in v3.1</span></a>
<a class="dropdown-item unclickable-btn" href="
                #">v3.0<span class="tooltiptext">This doc does not exist in v3.0</span></a>
<a class="dropdown-item unclickable-btn" href="
                #">v2.1<span class="tooltiptext">This doc does not exist in v2.1</span></a></div>
</div>
<div class="st_tree nav-toc docs-nav-toc"><ul><li class="has-child"><a href="#">
<span>关于 TiDB</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/overview/">
<span>TiDB 简介</span>
</a>
</li><li class="has-child"><a href="#">
<span>Benchmark 测试</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/benchmark/how-to-run-sysbench/">
<span>如何用 Sysbench 测试 TiDB</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/benchmark/how-to-run-tpcc/">
<span>如何对 TiDB 进行 TPC-C 测试</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/benchmark/sysbench-v4/">
<span>Sysbench 性能对比 - v3.0 对比 v2.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/benchmark/tpcc/">
<span>TPC-C 性能对比 - v3.0 对比 v2.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/benchmark/add-index-with-load/">
<span class="has-code">线上负载与 `Add Index` 相互影响测试</span>
</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">
<span>主要概念</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/architecture/">
<span>整体架构</span>
</a>
</li><li class="has-child"><a href="#">
<span>核心特性</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/key-features/#%e6%b0%b4%e5%b9%b3%e6%89%a9%e5%b1%95">
<span>水平扩展</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/key-features/#%e9%ab%98%e5%8f%af%e7%94%a8">
<span>高可用</span>
</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">
<span>操作指南</span>
<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">
<span>快速上手</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/deploy-tidb-from-docker-compose/">
<span>使用 Docker Compose 部署 TiDB</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/explore-sql/">
<span>SQL 基本操作</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/read-historical-data/">
<span>读取历史数据</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/tidb-binlog/">
<span>TiDB Binlog 教程</span>
</a>
</li><li class="leaf-child">
<a href="https://pingcap.com/docs-cn/tidb-data-migration/stable/get-started/">
<span>TiDB Data Migration 教程</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/tidb-lightning/">
<span>TiDB Lightning 教程</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/get-started/tispark/">
<span>TiSpark 教程</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>部署</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/hardware-recommendations/">
<span>软硬件环境需求</span>
</a>
</li><li class="has-child"><a href="#">
<span>集群部署方式</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/orchestrated/tiup/">
<span>使用 TiUP 部署（推荐）</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/orchestrated/ansible/">
<span>使用 Ansible 部署</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/orchestrated/offline-ansible/">
<span>使用 Ansible 离线部署</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/orchestrated/docker/">
<span>使用 Docker 部署</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>跨地域冗余</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/geographic-redundancy/overview/">
<span>跨数据中心部署方案</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/deploy/geographic-redundancy/location-awareness/">
<span>配置集群拓扑</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="https://pingcap.com/docs-cn/tidb-data-migration/stable/deploy-a-dm-cluster-using-ansible/">
<span>使用 Ansible 部署 DM 集群</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>配置</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/configure/time-zone/">
<span>时区</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/configure/memory-control/">
<span>内存控制</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/configure/placement-rules/">
<span>Placement Rules</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>安全</span>
<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">
<span>安全传输层协议 (TLS)</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/secure/enable-tls-clients/">
<span>为 MySQL 客户端开启 TLS</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/secure/enable-tls-between-components/">
<span>为 TiDB 组件间开启 TLS</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/secure/generate-self-signed-certificates/">
<span>生成自签名证书</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>监控</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/monitor/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/monitor/monitor-a-cluster/">
<span>监控 TiDB 集群</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>迁移</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/user-guide/">
<span>迁移工具使用指南</span>
</a>
</li><li class="has-child"><a href="#">
<span>从 MySQL 迁移</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/migrate/from-mysql-aurora/">
<span>以 Amazon Aurora MySQL 为例</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/csv/">
<span>从 CSV 迁移</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>运维</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/maintain/ansible-operations/">
<span>Ansible 常见运维操作</span>
</a>
</li><li class="has-child"><a href="#">
<span>备份与恢复</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/maintain/backup-and-restore/mydumper-lightning/">
<span>使用 Mydumper/TiDB Lightning 进行备份与恢复</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/br/br/">
<span>使用 BR 进行备份与恢复</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/br/use-cases/">
<span>BR 备份与恢复场景示例</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>定位异常查询</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/maintain/identify-abnormal-queries/identify-slow-queries/">
<span>定位慢查询</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/maintain/identify-abnormal-queries/identify-expensive-queries/">
<span>定位消耗系统资源多的查询</span>
</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">
<span>扩容缩容</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/scale/with-ansible/">
<span>使用 Ansible 扩容缩容</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>升级</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/upgrade/using-tiup/">
<span>使用 TiUP 升级（推荐）</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/upgrade/from-previous-version/">
<span>使用 TiDB Ansible 升级</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>故障诊断</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/how-to/troubleshoot/cluster-setup/">
<span>集群配置诊断</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/troubleshoot/tidb-lightning/">
<span>TiDB Lightning 故障诊断</span>
</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">
<span>参考手册</span>
<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">
<span>SQL</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/mysql-compatibility/">
<span>与 MySQL 兼容性对比</span>
</a>
</li><li class="has-child"><a href="#">
<span>SQL 语言结构</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/literal-values/">
<span>字面值</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/schema-object-names/">
<span>Schema 对象名</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/keywords-and-reserved-words/">
<span>关键字和保留字</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/user-defined-variables/">
<span>用户自定义变量</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/expression-syntax/">
<span>表达式语法</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/language-structure/comment-syntax/">
<span>注释语法</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>表属性和列属性</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/attributes/auto-random/">
<span class="has-code">`AUTO_RANDOM`</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>数据类型</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/default-values/">
<span>默认值</span>
</a>
</li><li class="has-child"><a href="#">
<span>数值类型</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#bit-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`BIT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#boolean-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`BOOL|BOOLEAN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#tinyint-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`TINYINT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#smallint-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`SMALLINT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#mediumint-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`MEDIUMINT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#integer-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`INT|INTEGER`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#bigint-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`BIGINT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#decimal-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`DECIMAL`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#float-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`FLOAT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/numeric/#double-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`DOUBLE`</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>日期和时间类型</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/date-and-time/#date-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`DATE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/date-and-time/#datetime-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`DATETIME`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/date-and-time/#timestamp-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`TIMESTAMP`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/date-and-time/#time-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`TIME`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/date-and-time/#year-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`YEAR`</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>字符串类型</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#char-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`CHAR`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#varchar-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`VARCHAR`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#text-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`TEXT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#longtext-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`LONGTEXT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#binary-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`BINARY`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#varbinary-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`VARBINARY`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#tinyblob-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`TINYBLOB`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#blob-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`BLOB`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#mediumblob-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`MEDIUMBLOB`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#longblob-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`LONGBLOB`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#enum-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`ENUM`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/string/#set-%e7%b1%bb%e5%9e%8b">
<span class="has-code">`SET`</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/data-types/json/">
<span>JSON Type</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>函数与操作符</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/reference/">
<span>函数与操作符概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/type-conversion/">
<span>表达式求值的类型转换</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/operators/">
<span>操作符</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/control-flow-functions/">
<span>控制流程函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/string-functions/">
<span>字符串函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/numeric-functions-and-operators/">
<span>数值函数与操作符</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/date-and-time-functions/">
<span>日期和时间函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/bit-functions-and-operators/">
<span>位函数和操作符</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/cast-functions-and-operators/">
<span>Cast 函数和操作符</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/encryption-and-compression-functions/">
<span>加密和压缩函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/information-functions/">
<span>信息函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/json-functions/">
<span>JSON 函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/aggregate-group-by-functions/">
<span>GROUP BY 聚合函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/window-functions/">
<span>窗口函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/miscellaneous-functions/">
<span>其它函数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/precision-math/">
<span>精度数学</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/functions-and-operators/expressions-pushed-down/">
<span>下推到 TiKV 的表达式列表</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>SQL 语句</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/add-column/">
<span class="has-code">`ADD COLUMN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/add-index/">
<span class="has-code">`ADD INDEX`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/admin/">
<span class="has-code">`ADMIN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/alter-database/">
<span class="has-code">`ALTER DATABASE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/alter-table/">
<span class="has-code">`ALTER TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/alter-user/">
<span class="has-code">`ALTER USER`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/analyze-table/">
<span class="has-code">`ANALYZE TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/begin/">
<span class="has-code">`BEGIN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/commit/">
<span class="has-code">`COMMIT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-database/">
<span class="has-code">`CREATE DATABASE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-index/">
<span class="has-code">`CREATE INDEX`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-sequence/">
<span class="has-code">`CREATE SEQUENCE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-table-like/">
<span class="has-code">`CREATE TABLE LIKE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-table/">
<span class="has-code">`CREATE TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-user/">
<span class="has-code">`CREATE USER`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/create-view/">
<span class="has-code">`CREATE VIEW`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/deallocate/">
<span class="has-code">`DEALLOCATE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/delete/">
<span class="has-code">`DELETE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/desc/">
<span class="has-code">`DESC`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/describe/">
<span class="has-code">`DESCRIBE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/do/">
<span class="has-code">`DO`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-column/">
<span class="has-code">`DROP COLUMN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-database/">
<span class="has-code">`DROP DATABASE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-index/">
<span class="has-code">`DROP INDEX`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-sequence/">
<span class="has-code">`DROP SEQUENCE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-table/">
<span class="has-code">`DROP TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-user/">
<span class="has-code">`DROP USER`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/drop-view/">
<span class="has-code">`DROP VIEW`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/execute/">
<span class="has-code">`EXECUTE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/explain-analyze/">
<span class="has-code">`EXPLAIN ANALYZE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/explain/">
<span class="has-code">`EXPLAIN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/flashback-table/">
<span class="has-code">`FLASHBACK TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/flush-privileges/">
<span class="has-code">`FLUSH PRIVILEGES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/flush-status/">
<span class="has-code">`FLUSH STATUS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/flush-tables/">
<span class="has-code">`FLUSH TABLES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/grant-privileges/">
<span class="has-code">`GRANT &lt;privileges&gt;`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/insert/">
<span class="has-code">`INSERT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/kill/">
<span class="has-code">`KILL [TIDB]`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/load-data/">
<span class="has-code">`LOAD DATA`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/modify-column/">
<span class="has-code">`MODIFY COLUMN`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/prepare/">
<span class="has-code">`PREPARE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/recover-table/">
<span class="has-code">`RECOVER TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/rename-index/">
<span class="has-code">`RENAME INDEX`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/rename-table/">
<span class="has-code">`RENAME TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/replace/">
<span class="has-code">`REPLACE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/revoke-privileges/">
<span class="has-code">`REVOKE &lt;privileges&gt;`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/rollback/">
<span class="has-code">`ROLLBACK`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/select/">
<span class="has-code">`SELECT`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/set-names/">
<span class="has-code">`SET [NAMES|CHARACTER SET]`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/set-password/">
<span class="has-code">`SET PASSWORD`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/set-transaction/">
<span class="has-code">`SET TRANSACTION`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/set-variable/">
<span class="has-code">`SET [GLOBAL|SESSION] &lt;variable&gt;`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-character-set/">
<span class="has-code">`SHOW CHARACTER SET`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-collation/">
<span class="has-code">`SHOW COLLATION`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-columns-from/">
<span class="has-code">`SHOW [FULL] COLUMNS FROM`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-create-sequence/">
<span class="has-code">`SHOW CREATE SEQUENCE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-create-table/">
<span class="has-code">`SHOW CREATE TABLE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-create-user/">
<span class="has-code">`SHOW CREATE USER`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-databases/">
<span class="has-code">`SHOW DATABASES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-engines/">
<span class="has-code">`SHOW ENGINES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-errors/">
<span class="has-code">`SHOW ERRORS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-fields-from/">
<span class="has-code">`SHOW [FULL] FIELDS FROM`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-grants/">
<span class="has-code">`SHOW GRANTS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-indexes/">
<span class="has-code">`SHOW INDEXES [FROM|IN]`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-index/">
<span class="has-code">`SHOW INDEX [FROM|IN]`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-keys/">
<span class="has-code">`SHOW KEYS [FROM|IN]`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-privileges/">
<span class="has-code">`SHOW PRIVILEGES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-processlist/">
<span class="has-code">`SHOW [FULL] PROCESSSLIST`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-schemas/">
<span class="has-code">`SHOW SCHEMAS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-tables/">
<span class="has-code">`SHOW [FULL] TABLES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-table-regions/">
<span class="has-code">`SHOW TABLE REGIONS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-table-status/">
<span class="has-code">`SHOW TABLE STATUS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-variables/">
<span class="has-code">`SHOW [GLOBAL|SESSION] VARIABLES`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/show-warnings/">
<span class="has-code">`SHOW WARNINGS`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/split-region/">
<span class="has-code">`SPLIT REGION`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/start-transaction/">
<span class="has-code">`START TRANSACTION`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/trace/">
<span class="has-code">`TRACE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/truncate/">
<span class="has-code">`TRUNCATE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/update/">
<span class="has-code">`UPDATE`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/statements/use/">
<span class="has-code">`USE`</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/constraints/">
<span>约束</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/generated-columns/">
<span>生成列</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/partitioning/">
<span>分区表</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/character-set/">
<span>字符集</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/sql-mode/">
<span>SQL 模式</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/sql-diagnosis/">
<span>SQL 诊断</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/sql/view/">
<span>视图</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>配置</span>
<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">
<span>tidb-server</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tidb-server/mysql-variables/">
<span>MySQL 系统变量</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tidb-server/tidb-specific-variables/">
<span>TiDB 特定系统变量</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tidb-server/configuration/">
<span>配置参数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tidb-server/configuration-file/">
<span>配置文件描述</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>pd-server</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/pd-server/configuration/">
<span>配置参数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/pd-server/configuration-file/">
<span>配置文件描述</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>tikv-server</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tikv-server/configuration/">
<span>配置参数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/configuration/tikv-server/configuration-file/">
<span>配置文件描述</span>
</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">
<span>安全</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/security/compatibility/">
<span>与 MySQL 的安全特性差异</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/security/privilege-system/">
<span>TiDB 数据库权限管理</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/security/user-account-management/">
<span>TiDB 用户账户管理</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/security/role-based-access-control/">
<span>基于角色的访问控制</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/security/cert-based-authentication/">
<span>TiDB 证书鉴权使用指南</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>事务</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/transactions/overview/">
<span>事务概览</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/transactions/transaction-isolation/">
<span>隔离级别</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/transactions/transaction-optimistic/">
<span>乐观事务</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/transactions/transaction-pessimistic/">
<span>悲观事务</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>系统数据库</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/mysql/">
<span class="has-code">`mysql`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/information-schema/">
<span class="has-code">`information_schema`</span>
</a>
</li><li class="has-child"><a href="#">
<span class="has-code">`sql-diagnosis`</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-info/">
<span class="has-code">`cluster_info`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-hardware/">
<span class="has-code">`cluster_hardware`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-config/">
<span class="has-code">`cluster_config`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-load/">
<span class="has-code">`cluster_load`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-systeminfo/">
<span class="has-code">`cluster_systeminfo`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/cluster-log/">
<span class="has-code">`cluster_log`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/metrics-schema/">
<span class="has-code">`metrics_schema`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/metrics-tables/">
<span class="has-code">`metrics_tables`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/metrics-summary/">
<span class="has-code">`metrics_summary`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/inspection-result/">
<span class="has-code">`inspection_result`</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/system-databases/inspection-summary/">
<span class="has-code">`inspection_summary`</span>
</a>
</li></ul>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/error-codes/">
<span>错误码</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/supported-clients/">
<span>支持的连接器和 API</span>
</a>
</li><li class="has-child"><a href="#">
<span>垃圾回收 (GC)</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/garbage-collection/overview/">
<span>GC 机制简介</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/garbage-collection/configuration/">
<span>GC 配置</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>性能调优</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/sql-optimizer-overview/">
<span>SQL 优化流程</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/understanding-the-query-execution-plan/">
<span>理解 TiDB 执行计划</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/execution-plan-bind/">
<span>执行计划绑定</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/join-reorder/">
<span>Join Reorder 算法简介</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/statistics/">
<span>统计信息概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/optimizer-hints/">
<span>Optimizer Hints</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/follower-read/">
<span>Follower Read</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/check-cluster-status-using-sql-statements/">
<span>使用 SQL 语句检查 TiDB 集群状态</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/index-merge/">
<span>使用 Index Merge 方式访问表</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/statement-summary/">
<span>Statement Summary Table</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/performance/tune-tikv/">
<span>TiKV 调优</span>
</a>
</li><li class="leaf-child">
<a href="https://pingcap.com/blog-cn/tidb-best-practice/">
<span>TiDB 最佳实践</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>监控指标</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/key-monitoring-metrics/overview-dashboard/">
<span>Overview 面板</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/key-monitoring-metrics/tidb-dashboard/">
<span>TiDB 面板</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/key-monitoring-metrics/pd-dashboard/">
<span>PD 面板</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/key-monitoring-metrics/tikv-dashboard/">
<span>TiKV 面板</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/alert-rules/">
<span>报警规则</span>
</a>
</li><li class="has-child"><a href="#">
<span>最佳实践</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/haproxy/">
<span>HAProxy 最佳实践</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/java-app/">
<span>Java 应用开发最佳实践</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/high-concurrency/">
<span>高并发写入场景最佳实践</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/grafana-monitor/">
<span>Grafana 监控最佳实践</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/pd-scheduling/">
<span>PD 调度策略最佳实践</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/best-practices/massive-regions/">
<span>海量 Region 集群调优最佳实践</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tispark/">
<span>TiSpark 使用指南</span>
</a>
</li><li class="has-child"><a href="#">
<span>TiFlash</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/deploy/">
<span>部署集群</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/use-tiflash/">
<span>使用 TiFlash</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/maintain/">
<span>运维集群</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/monitor/">
<span>监控集群</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/scale/with-tiup/#2-%e6%89%a9%e5%ae%b9-tiflash-%e8%8a%82%e7%82%b9">
<span>扩缩容集群</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/upgrade/">
<span>升级节点</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/configuration/">
<span>配置参数</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/alert-rules/">
<span>报警规则</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/tune-performance/">
<span>性能调优</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tiflash/faq/">
<span>FAQ</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>TiDB Binlog</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/deploy/">
<span>部署使用</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/maintain/">
<span>运维管理</span>
</a>
</li><li class="has-child"><a href="#">
<span>配置说明</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/configs/#pump">
<span>Pump</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/configs/#drainer">
<span>Drainer</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/upgrade/">
<span>版本升级</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/monitor/">
<span>监控告警</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/reparo/">
<span>增量恢复</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/binlog-slave-client/">
<span>Kafka 自定义开发</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/relay-log/">
<span>TiDB Binlog Relay Log</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/bi-repl/">
<span>集群间双向同步</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/glossary/">
<span>术语表</span>
</a>
</li><li class="has-child"><a href="#">
<span>故障诊断</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/troubleshoot/binlog/">
<span>故障诊断</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/troubleshoot/error-handling/">
<span>常见错误修复</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tidb-binlog/faq/">
<span>FAQ</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>周边工具</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/user-guide/">
<span>工具使用指南</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/mydumper/">
<span>Mydumper</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/loader/">
<span>Loader</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/syncer/">
<span>Syncer</span>
</a>
</li><li class="leaf-child">
<a href="https://pingcap.com/docs-cn/tidb-data-migration/stable/">
<span>Data Migration</span>
</a>
</li><li class="has-child"><a href="#">
<span>TiDB Lightning</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/deployment/">
<span>部署执行</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/config/">
<span>参数说明</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/checkpoints/">
<span>断点续传</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/table-filter/">
<span>表库过滤</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/csv/">
<span>CSV 支持</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/tidb-backend/">
<span>TiDB-backend</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/web/">
<span>Web 界面</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/monitor/">
<span>监控告警</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/how-to/troubleshoot/tidb-lightning/">
<span>故障诊断</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/faq/tidb-lightning/">
<span>FAQ</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-lightning/glossary/">
<span>术语表</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>TiCDC</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/ticdc/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/ticdc/deploy/">
<span>部署使用</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/ticdc/manage/">
<span>集群和同步任务管理</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/ticdc/sink/">
<span>Sink URI 配置规则</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>sync-diff-inspector</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/sync-diff-inspector/overview/">
<span>概述</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/sync-diff-inspector/route-diff/">
<span>不同库名或表名的数据校验</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/sync-diff-inspector/shard-diff/">
<span>分库分表场景下的数据校验</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/sync-diff-inspector/tidb-diff/">
<span>TiDB 主从集群的数据校验</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/pd-control/">
<span>PD Control</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/pd-recover/">
<span>PD Recover</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tikv-control/">
<span>TiKV Control</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/tidb-control/">
<span>TiDB Controller</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/reference/tools/download/">
<span>工具下载</span>
</a>
</li></ul>
</li></ul>
</li><li class="leaf-child">
<a href="https://pingcap.com/docs-cn/tidb-in-kubernetes/stable/">
<span>TiDB in Kubernetes</span>
</a>
</li><li class="has-child"><a href="#">
<span>常见问题 (FAQ)</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/faq/tidb/">
<span>TiDB FAQ</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/faq/tidb-lightning/">
<span>TiDB Lightning FAQ</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/faq/upgrade/">
<span>升级 FAQ</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>技术支持</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/support-resources/">
<span>支持渠道</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/report-issue/">
<span>反馈问题</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>贡献</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/contribute/#%e6%88%90%e4%b8%ba-tidb-%e7%9a%84%e8%b4%a1%e7%8c%ae%e8%80%85">
<span>贡献代码</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/contribute/#%e6%94%b9%e8%bf%9b%e6%96%87%e6%a1%a3">
<span>改进文档</span>
</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/roadmap/">
<span>TiDB 路线图</span>
</a>
</li><li class="has-child"><a href="#">
<span>版本发布历史</span>
<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">
<span>v4.0</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/4.0.0-rc/">
<span>4.0.0-rc</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/4.0.0-beta.2/">
<span>4.0.0-beta.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/4.0.0-beta.1/">
<span>4.0.0-beta.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/4.0.0-beta/">
<span>4.0.0-beta</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>v3.1</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.1.0-rc/">
<span>3.1.0-rc</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.1.0-beta.2/">
<span>3.1.0-beta.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.1.0-beta.1/">
<span>3.1.0-beta.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.1.0-beta/">
<span>3.1.0-beta</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>v3.0</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.12/">
<span>3.0.12</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.11/">
<span>3.0.11</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.10/">
<span>3.0.10</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.9/">
<span>3.0.9</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.8/">
<span>3.0.8</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.7/">
<span>3.0.7</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.6/">
<span>3.0.6</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.5/">
<span>3.0.5</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.4/">
<span>3.0.4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.3/">
<span>3.0.3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.2/">
<span>3.0.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.1/">
<span>3.0.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0-ga/">
<span>3.0 GA</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.0-rc.3/">
<span>3.0.0-rc.3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.0-rc.2/">
<span>3.0.0-rc.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.0-rc.1/">
<span>3.0.0-rc.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0.0-beta.1/">
<span>3.0.0-beta.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/3.0beta/">
<span>3.0.0-beta</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>v2.1</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.19/">
<span>2.1.19</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.18/">
<span>2.1.18</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.17/">
<span>2.1.17</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.16/">
<span>2.1.16</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.15/">
<span>2.1.15</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.14/">
<span>2.1.14</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.13/">
<span>2.1.13</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.12/">
<span>2.1.12</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.11/">
<span>2.1.11</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.10/">
<span>2.1.10</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.9/">
<span>2.1.9</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.8/">
<span>2.1.8</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.7/">
<span>2.1.7</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.6/">
<span>2.1.6</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.5/">
<span>2.1.5</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.4/">
<span>2.1.4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.3/">
<span>2.1.3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.2/">
<span>2.1.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1.1/">
<span>2.1.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.1ga/">
<span>2.1 GA</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21rc5/">
<span>2.1 RC5</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21rc4/">
<span>2.1 RC4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21rc3/">
<span>2.1 RC3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21rc2/">
<span>2.1 RC2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21rc1/">
<span>2.1 RC1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/21beta/">
<span>2.1 Beta</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>v2.0</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.0.11/">
<span>2.0.11</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.0.10/">
<span>2.0.10</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/209/">
<span>2.0.9</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/208/">
<span>2.0.8</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/207/">
<span>2.0.7</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/206/">
<span>2.0.6</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/205/">
<span>2.0.5</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/204/">
<span>2.0.4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/203/">
<span>2.0.3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/202/">
<span>2.0.2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/201/">
<span>2.0.1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2.0ga/">
<span>2.0</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2rc5/">
<span>2.0 RC5</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2rc4/">
<span>2.0 RC4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2rc3/">
<span>2.0 RC3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/2rc1/">
<span>2.0 RC1</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/11beta/">
<span>1.1 Beta</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/11alpha/">
<span>1.1 Alpha</span>
</a>
</li></ul>
</li><li class="has-child"><a href="#">
<span>v1.0</span>
<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs-cn/stable/releases/ga/">
<span>1.0</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/prega/">
<span>Pre-GA</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/rc4/">
<span>RC4</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/rc3/">
<span>RC3</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/rc2/">
<span>RC2</span>
</a>
</li><li class="leaf-child">
<a href="/docs-cn/stable/releases/rc1/">
<span>RC1</span>
</a>
</li></ul>
</li></ul>
</li><li class="leaf-child">
<a href="/docs-cn/stable/glossary/">
<span>术语表</span>
</a>
</li></ul>
</div>
</div>
</div>
<div class="archive">
<div class="content markdown-body">
<h1 id="-tiup--tidb-">使用 TiUP 部署 TiDB 集群</h1>
<p><a href="https://github.com/pingcap-incubator/tiup">TiUP</a> 是 TiDB 4.0 版本引入的集群运维工具，<a href="https://github.com/pingcap-incubator/tiup-cluster">TiUP cluster</a> 是 TiUP 提供的使用 Golang 编写的集群管理组件，通过 TiUP cluster 组件就可以进行日常的运维工作，包括部署、启动、关闭、销毁、弹性扩缩容、升级 TiDB 集群；管理 TiDB 集群参数；部署 TiDB Binlog；部署 TiFlash 等。</p>
<p>本文介绍了使用 TiUP 部署 TiDB 集群的流程，具体步骤如下：</p>
<ul>
<li><a href="#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">1. 环境准备</a></li>
<li><a href="#2-%E9%85%8D%E7%BD%AE%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6-topologyyaml">2. 配置初始化参数文件 <code>topology.yaml</code></a></li>
<li><a href="#3-%E6%89%A7%E8%A1%8C%E9%83%A8%E7%BD%B2%E5%91%BD%E4%BB%A4">3. 执行部署命令</a></li>
<li><a href="#4-%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E7%8A%B6%E6%80%81">4. 验证集群部署状态</a></li>
<li><a href="#5-%E5%90%AF%E5%8A%A8%E9%9B%86%E7%BE%A4">5. 启动集群</a></li>
<li><a href="#6-%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81">6. 验证集群运行状态</a></li>
</ul>
<p>另外，本文还提供了使用 TiUP 关闭、销毁集群的命令，以及使用 TiUP 部署的常见问题和解决方案。具体参见：</p>
<ul>
<li><a href="#7-%E5%85%B3%E9%97%AD%E9%9B%86%E7%BE%A4">7. 关闭集群</a></li>
<li><a href="#8-%E9%94%80%E6%AF%81%E9%9B%86%E7%BE%A4">8. 销毁集群</a></li>
<li><a href="#9-%E5%B8%B8%E8%A7%81%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98">9. 常见部署问题</a></li>
</ul>
<h2 id="1-">1. 环境准备</h2>
<p>环境准备环节分为如下几步：</p>
<ul>
<li><a href="#%E7%AC%AC-1-%E6%AD%A5%E8%BD%AF%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">第 1 步：软硬件环境配置</a></li>
<li><a href="#%E7%AC%AC-2-%E6%AD%A5%E5%9C%A8%E4%B8%AD%E6%8E%A7%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85-tiup-%E7%BB%84%E4%BB%B6">第 2 步：在中控机上安装 TiUP 组件</a></li>
<li><a href="#%E7%AC%AC-3-%E6%AD%A5%E5%9C%A8-tikv-%E9%83%A8%E7%BD%B2%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8%E4%B8%8A%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%9B%98-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0">第 3 步：在 TiKV 部署目标机器上添加数据盘 EXT4 文件系统挂载参数</a></li>
</ul>
<h3 id="-1-">第 1 步：软硬件环境配置</h3>
<p>中控机软硬件配置建议如下：</p>
<ul>
<li>中控机可以是部署目标机器中的某一台</li>
<li>推荐安装 CentOS 7.3 及以上版本 Linux 操作系统</li>
<li>该机器需开放外网访问，用于下载 TiDB 及相关软件安装包</li>
<li>需要安装 TiUP 组件（参考<a href="#%E7%AC%AC-2-%E6%AD%A5%E5%9C%A8%E4%B8%AD%E6%8E%A7%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85-tiup-%E7%BB%84%E4%BB%B6">第 2 步</a>）</li>
</ul>
<p>目标主机软硬件配置建议如下：</p>
<ul>
<li>建议 4 台及以上，TiKV 至少 3 实例，且与 TiDB、PD 模块不位于同一主机，详见部署建议</li>
<li>目前 TiUP 仅支持在 x86_64 (AMD64) 架构上部署 TiDB 集群（TiUP 将在 4.0 GA 时支持在 ARM 架构上部署）
<ul>
<li>在 AMD64 架构下，建议使用 CentOS 7.3 及以上版本 Linux 操作系统</li>
<li>在 ARM 架构下，建议使用 CentOS 7.6 1810 版本 Linux 操作系统</li>
</ul>
</li>
<li>TiKV 数据文件的文件系统推荐使用 EXT4 格式，也可以使用 CentOS 默认的 XFS 格式（参考<a href="#%E7%AC%AC-3-%E6%AD%A5%E5%9C%A8-tikv-%E9%83%A8%E7%BD%B2%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8%E4%B8%8A%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%9B%98-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0">第 3 步</a>）</li>
<li>机器之间内网互通（建议关闭防火墙 <code>firewalld</code>，或者开放 TiDB 集群的节点间所需端口）</li>
<li>如果需要绑核操作，需要安装 <code>numactl</code> 工具</li>
</ul>
<p>其他软硬件环境配置可参考官方文档 <a href="/docs-cn/stable/how-to/deploy/hardware-recommendations">TiDB 软件和硬件环境建议配置</a>。</p>
<h3 id="-2--tiup-">第 2 步：在中控机上安装 TiUP 组件</h3>
<p>使用普通用户登录中控机，以 <code>tidb</code> 用户为例，后续安装 TiUP 及集群管理操作均通过该用户完成：</p>
<ol>
<li>
<p>执行如下命令安装 TiUP 工具：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">curl --proto <span style="color:#e6db74">'=https'</span> --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh
</code></pre></div><p>执行成功输出结果样例：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                Dload  Upload   Total   Spent    Left  Speed
100 6029k  100 6029k    0     0  2384k      0  0:00:02  0:00:02 --:--:-- 2385k
Detected shell: /bin/bash
Shell profile:  /home/tidb/.bash_profile
/home/tidb/.bash_profile has been modified to to add tiup to PATH
open a new terminal or source /home/tidb/.bash_profile to use it
Installed path: /home/tidb/.tiup/bin/tiup
===============================================
Have a try:     tiup playground
===============================================
</code></pre></div></li>
<li>
<p>按如下步骤设置 TiUP 环境变量：</p>
<p>重新声明全局环境变量：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">source .bash_profile
</code></pre></div><p>确认 TiUP 工具是否安装：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">which tiup
</code></pre></div></li>
<li>
<p>安装 TiUP cluster 组件（以 cluster-v0.4.3 为例）</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster
</code></pre></div><p>预期结果输出：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">The component `cluster` is not installed; downloading from repository.
download https://tiup-mirrors.pingcap.com/cluster-v0.4.3-linux-amd64.tar.gz:
17400435 / 17400435 [---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% ? p/s
Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster
Deploy a TiDB cluster for production

Usage:
cluster [flags]
cluster [command]

Available Commands:
deploy      Deploy a cluster for production
start       Start a TiDB cluster
stop        Stop a TiDB cluster
restart     Restart a TiDB cluster
scale-in    Scale in a TiDB cluster
scale-out   Scale out a TiDB cluster
destroy     Destroy a specified cluster
upgrade     Upgrade a specified TiDB cluster
exec        Run shell command on host in the tidb cluster
display     Display information of a TiDB cluster
list        List all clusters
audit       Show audit log of cluster operation
import      Import an exist TiDB cluster from TiDB-Ansible
edit-config Edit TiDB cluster config
reload      Reload a TiDB cluster's config and restart if needed
help        Help about any command

Flags:
-h, --help      help for cluster
    --version   version for cluster

Use "cluster [command] --help" for more information about a command.

# cluster 组件提供以下集群管理功能
# deploy      集群部署
# start       启动 TiDB 集群
# stop        关闭 TiDB 集群
# restart     重启 TiDB 集群
# scale-in    扩容 TiDB 集群
# scale-out   缩容 TiDB 集群
# destroy     销毁指定 TiDB 集群
# upgrade     升级指定 TiDB 集群
# exec        在 TiDB 集群的目标主机执行命令
# display     展示 TiDB 集群信息
# list        展示管理的 TiDB 集群
# audit       审计 TiUP 历史操作命令
# import      导入 TiDB-Ansible 部署的 TiDB 集群
# edit-config 编辑 TiDB 集群参数
# reload      重新加载 TiDB 集群或者指定实例的参数配置
# help        帮助信息
</code></pre></div></li>
<li>
<p>如果已经安装，则更新 TiUP cluster 组件至最新版本：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup update cluster
</code></pre></div><p>预期输出如下 <code>“Update successfully!”</code> 字样：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">The `cluster:v0.4.3` has been installed
Update successfully!
</code></pre></div></li>
<li>
<p>验证当前 TiUP cluster 版本信息。执行如下命令查看 TiUP cluster 组件版本：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup --binary cluster
</code></pre></div><p>预期结果输出（当前版本为 v0.4.3）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/home/tidb/.tiup/components/cluster/v0.4.3/cluster
</code></pre></div></li>
</ol>
<h3 id="-3--tikv--ext4-">第 3 步：在 TiKV 部署目标机器上添加数据盘 EXT4 文件系统挂载参数</h3>
<blockquote>
<p><strong>注意：</strong></p>
<p>推荐 TiKV 部署目标机器的数据目录使用 EXT4 文件系统格式。相比于 XFS 文件系统格式，EXT4 文件系统格式在 TiDB 集群部署案例较多，生产环境优先选择使用 EXT4 文件系统格式。</p>
</blockquote>
<p>使用 <code>root</code> 用户登录目标机器，将部署目标机器数据盘格式化成 ext4 文件系统，挂载时添加 <code>nodelalloc</code> 和 <code>noatime</code> 挂载参数。<code>nodelalloc</code> 是必选参数，否则 TiUP 安装时检测无法通过；<code>noatime</code> 是可选建议参数。</p>
<blockquote>
<p><strong>注意：</strong></p>
<p>如果你的数据盘已经格式化成 ext4 并挂载了磁盘，可先执行 <code>umount /dev/nvme0n1p1</code> 命令卸载，从编辑 <code>/etc/fstab</code> 文件步骤开始执行，添加挂载参数重新挂载即可。</p>
</blockquote>
<p>以 <code>/dev/nvme0n1</code> 数据盘为例，具体操作步骤如下：</p>
<ol>
<li>
<p>查看数据盘。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">fdisk -l
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Disk /dev/nvme0n1: 1000 GB
</code></pre></div></li>
<li>
<p>创建分区表。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">parted -s -a optimal /dev/nvme0n1 mklabel gpt -- mkpart primary ext4 <span style="color:#ae81ff">1</span> -1
</code></pre></div><blockquote>
<p><strong>注意：</strong></p>
<p>使用 <code>lsblk</code> 命令查看分区的设备号：对于 nvme 磁盘，生成的分区设备号一般为 <code>nvme0n1p1</code>；对于普通磁盘（例如 <code>/dev/sdb</code>），生成的的分区设备号一般为 <code>sdb1</code>。</p>
</blockquote>
</li>
<li>
<p>格式化文件系统。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkfs.ext4 /dev/nvme0n1p1
</code></pre></div></li>
<li>
<p>查看数据盘分区 UUID。</p>
<p>本例中 <code>nvme0n1p1</code> 的 UUID 为 <code>c51eb23b-195c-4061-92a9-3fad812cc12f</code>。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lsblk -f
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">NAME    FSTYPE LABEL UUID                                 MOUNTPOINT
sda
├─sda1  ext4         237b634b-a565-477b-8371-6dff0c41f5ab /boot
├─sda2  swap         f414c5c0-f823-4bb1-8fdf-e531173a72ed
└─sda3  ext4         547909c1-398d-4696-94c6-03e43e317b60 /
sr0
nvme0n1
└─nvme0n1p1 ext4         c51eb23b-195c-4061-92a9-3fad812cc12f
</code></pre></div></li>
<li>
<p>编辑 <code>/etc/fstab</code> 文件，添加 <code>nodelalloc</code> 挂载参数。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vi /etc/fstab
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">UUID=c51eb23b-195c-4061-92a9-3fad812cc12f /data1 ext4 defaults,nodelalloc,noatime 0 2
</code></pre></div></li>
<li>
<p>挂载数据盘。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir /data1 <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>mount -a
</code></pre></div></li>
<li>
<p>执行以下命令，如果文件系统为 ext4，并且挂载参数中包含 <code>nodelalloc</code>，则表示已生效。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mount -t ext4
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/dev/nvme0n1p1 on /data1 type ext4 (rw,noatime,nodelalloc,data=ordered)
</code></pre></div></li>
</ol>
<h2 id="2--topologyyaml">2. 配置初始化参数文件 <code>topology.yaml</code></h2>
<p>集群初始化配置文件需要手动编写，完整的全配置参数模版可以参考 <a href="https://github.com/pingcap-incubator/tiops/blob/master/topology.example.yaml">Github TiUP 项目</a>。</p>
<p>需要在中控机上面创建 YAML 格式配置文件，例如 <code>topology.yaml</code>。下文介绍 3 个经典场景的集群配置模版：</p>
<ul>
<li><a href="#%E5%9C%BA%E6%99%AF-1%E5%8D%95%E6%9C%BA%E5%8D%95%E5%AE%9E%E4%BE%8B">场景 1：单机单实例</a></li>
<li><a href="#%E5%9C%BA%E6%99%AF-2%E5%8D%95%E6%9C%BA%E5%A4%9A%E5%AE%9E%E4%BE%8B">场景 2：单机多实例</a></li>
<li><a href="#%E5%9C%BA%E6%99%AF-3tidb-binlog-%E9%83%A8%E7%BD%B2%E6%A8%A1%E7%89%88">场景 3：TiDB Binlog 部署模版</a></li>
</ul>
<h3 id="-1">场景 1：单机单实例</h3>
<h4 id="heading">部署需求</h4>
<p>通过 <code>tidb</code> 用户做集群管理，使用默认 <code>22</code> 端口，部署目录为 <code>/tidb-deploy</code>，数据目录为 <code>/tidb-data</code>。</p>
<h4 id="heading-1">拓扑信息</h4>
<table>
<thead>
<tr>
<th align="left">实例</th>
<th align="left">个数</th>
<th align="left">物理机配置</th>
<th align="left">IP</th>
<th align="left">配置</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TiKV</td>
<td align="left">3</td>
<td align="left">16 VCore 32GB * 1</td>
<td align="left">10.0.1.1 <br/> 10.0.1.2 <br/> 10.0.1.3</td>
<td align="left">默认端口 <br/> 全局目录配置</td>
</tr>
<tr>
<td align="left">TiDB</td>
<td align="left">3</td>
<td align="left">16 VCore 32GB * 1</td>
<td align="left">10.0.1.7 <br/> 10.0.1.8 <br/> 10.0.1.9</td>
<td align="left">默认端口 <br/>  全局目录配置</td>
</tr>
<tr>
<td align="left">PD</td>
<td align="left">3</td>
<td align="left">4 VCore 8GB * 1</td>
<td align="left">10.0.1.4 <br/> 10.0.1.5 <br/> 10.0.1.6</td>
<td align="left">默认端口 <br/> 全局目录配置</td>
</tr>
<tr>
<td align="left">TiFlash</td>
<td align="left">1</td>
<td align="left">32 VCore 64 GB * 1</td>
<td align="left">10.0.1.10</td>
<td align="left">默认端口 <br/> 全局目录配置</td>
</tr>
</tbody>
</table>
<h4 id="-4--topologyyaml">第 4 步：配置文件模版 topology.yaml</h4>
<blockquote>
<p><strong>注意：</strong></p>
<ul>
<li>
<p>无需手动创建 tidb 用户，TiUP cluster 组件会在部署主机上自动创建该用户。可以自定义用户，也可以和中控机的用户保持一致。</p>
</li>
<li>
<p><a href="/docs-cn/stable/reference/tiflash/deploy">部署 TiFlash</a> 需要在 topology.yaml 配置文件中将 <code>replication.enable-placement-rules</code> 设置为 <code>true</code>，以开启 PD 的 <a href="/docs-cn/stable/how-to/configure/placement-rules">Placement Rules</a> 功能。</p>
</li>
<li>
<p>tiflash_servers 实例级别配置 <code>"-host"</code> 目前只支持 IP，不支持域名。</p>
</li>
<li>
<p>TiFlash 具体的参数配置介绍可参考 <a href="#tiflash-%E5%8F%82%E6%95%B0">TiFlash 参数配置</a>。</p>
</li>
</ul>
</blockquote>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat topology.yaml
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># Global variables are applied to all deployments and as the default value of</span>
<span style="color:#75715e"># them if the specific deployment value missing.</span>
global:
  user: <span style="color:#e6db74">"tidb"</span>
  ssh_port: <span style="color:#ae81ff">22</span>
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data"</span>

monitored:
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data/monitored-9100"</span>
  log_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100/log"</span>

server_configs:
  tidb:
    log.slow-threshold: <span style="color:#ae81ff">300</span>
    log.level: warn
    binlog.enable: <span style="color:#66d9ef">false</span>
    binlog.ignore-error: <span style="color:#66d9ef">false</span>
  tikv:
    readpool.storage.use-unified-pool: <span style="color:#66d9ef">true</span>
    readpool.coprocessor.use-unified-pool: <span style="color:#66d9ef">true</span>
  pd:
    schedule.leader-schedule-limit: <span style="color:#ae81ff">4</span>
    schedule.region-schedule-limit: <span style="color:#ae81ff">2048</span>
    schedule.replica-schedule-limit: <span style="color:#ae81ff">64</span>
    replication.enable-placement-rules: <span style="color:#66d9ef">true</span>


pd_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
    <span style="color:#75715e"># ssh_port: 22</span>
    <span style="color:#75715e"># name: "pd-1"</span>
    <span style="color:#75715e"># client_port: 2379</span>
    <span style="color:#75715e"># peer_port: 2380</span>
    <span style="color:#75715e"># deploy_dir: "deploy/pd-2379"</span>
    <span style="color:#75715e"># data_dir: "data/pd-2379"</span>
    <span style="color:#75715e"># log_dir: "deploy/pd-2379/log"</span>
    <span style="color:#75715e"># numa_node: "0,1"</span>
    <span style="color:#75715e"># # Config is used to overwrite the `server_configs.pd` values</span>
    <span style="color:#75715e"># config:</span>
    <span style="color:#75715e">#   schedule.max-merge-region-size: 20</span>
    <span style="color:#75715e">#   schedule.max-merge-region-keys: 200000</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.5</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.6</span>
tidb_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
    <span style="color:#75715e"># ssh_port: 22</span>
    <span style="color:#75715e"># port: 4000</span>
    <span style="color:#75715e"># status_port: 10080</span>
    <span style="color:#75715e"># deploy_dir: "deploy/tidb-4000"</span>
    <span style="color:#75715e"># log_dir: "deploy/tidb-4000/log"</span>
    <span style="color:#75715e"># numa_node: "0,1"</span>
    <span style="color:#75715e"># # Config is used to overwrite the `server_configs.tidb` values</span>
    <span style="color:#75715e"># config:</span>
    <span style="color:#75715e">#   log.level: warn</span>
    <span style="color:#75715e">#   log.slow-query-file: tidb-slow-overwritten.log</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.8</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.9</span>
tikv_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.1</span>
    <span style="color:#75715e"># ssh_port: 22</span>
    <span style="color:#75715e"># port: 20160</span>
    <span style="color:#75715e"># status_port: 20180</span>
    <span style="color:#75715e"># deploy_dir: "deploy/tikv-20160"</span>
    <span style="color:#75715e"># data_dir: "data/tikv-20160"</span>
    <span style="color:#75715e"># log_dir: "deploy/tikv-20160/log"</span>
    <span style="color:#75715e"># numa_node: "0,1"</span>
    <span style="color:#75715e"># # Config is used to overwrite the `server_configs.tikv` values</span>
    <span style="color:#75715e">#  config:</span>
    <span style="color:#75715e">#    server.labels:</span>
    <span style="color:#75715e">#      zone: sh</span>
    <span style="color:#75715e">#      dc: sha</span>
    <span style="color:#75715e">#      rack: rack1</span>
    <span style="color:#75715e">#      host: host1</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.2</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.3</span>
tiflash_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.10</span>
    <span style="color:#75715e"># ssh_port: 22</span>
    <span style="color:#75715e"># tcp_port: 9000</span>
    <span style="color:#75715e"># http_port: 8123</span>
    <span style="color:#75715e"># flash_service_port: 3930</span>
    <span style="color:#75715e"># flash_proxy_port: 20170</span>
    <span style="color:#75715e"># flash_proxy_status_port: 20292</span>
    <span style="color:#75715e"># metrics_port: 8234</span>
    <span style="color:#75715e"># deploy_dir: deploy/tiflash-9000</span>
    <span style="color:#75715e"># data_dir: deploy/tiflash-9000/data</span>
    <span style="color:#75715e"># log_dir: deploy/tiflash-9000/log</span>
    <span style="color:#75715e"># numa_node: "0,1"</span>
    <span style="color:#75715e"># # Config is used to overwrite the `server_configs.tiflash` values</span>
    <span style="color:#75715e">#  config:</span>
    <span style="color:#75715e">#    logger:</span>
    <span style="color:#75715e">#      level: "info"</span>
    <span style="color:#75715e">#  learner_config:</span>
    <span style="color:#75715e">#    log-level: "info"</span>
monitoring_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
grafana_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
alertmanager_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
</code></pre></div><h3 id="-2">场景 2：单机多实例</h3>
<h4 id="heading-2">部署需求</h4>
<p>部署 TiDB 和 TiKV 组件的物理机为 2 路处理器，每路 16 VCore，内存也达标，为提高物理机资源利用率，可为单机多实例，即 TiDB、TiKV 通过 numa 绑核，隔离 CPU 资源。PD 和 Prometheus 混合部署，但两者的数据目录需要使用独立的文件系统。</p>
<h4 id="heading-3">单机多实例部署的关键参数配置</h4>
<p>本节介绍单机多实例的关键参数，主要用于 TiDB、TiKV 的单机多实例部署场景。你需要按照提供的计算公式，将结果填写至下一步的配置文件中。</p>
<ul>
<li>
<p>TiKV 进行配置优化</p>
<ul>
<li>
<p>readpool 线程池自适应，配置 <code>readpool.unified.max-thread-count</code> 参数可以使 <code>readpool.storage</code> 和 <code>readpool.coprocessor</code> 共用统一线程池，同时要分别开启自适应开关。计算公式如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">readpool.unified.max-thread-count = cores * 0.8 / TiKV 数量
</code></pre></div></li>
<li>
<p>storage CF (all RocksDB column families) 内存自适应，配置 <code>storage.block-cache.capacity</code> 参数即可实现 CF 之间自动平衡内存使用。计算公式如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">storage.block-cache.capacity = (MEM_TOTAL * 0.5 / TiKV 实例数量)
</code></pre></div></li>
<li>
<p>如果多个 TiKV 实例部署在同一块物理磁盘上，需要修改 <code>conf/tikv.yml</code> 中的 capacity 参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">raftstore.capactiy = 磁盘总容量 / TiKV 实例数量
</code></pre></div></li>
</ul>
</li>
<li>
<p>label 调度配置</p>
<p>由于采用单机多实例部署 TiKV，为了避免物理机宕机导致 Region Group 默认 3 副本的 2 副本丢失，导致集群不可用的问题，可以通过 label 来实现 PD 智能调度，保证同台机器的多 TiKV 实例不会出现 Region Group 只有 2 副本的情况。</p>
<ul>
<li>
<p>TiKV 配置</p>
<p>相同物理机配置相同的 host 级别 label 信息：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">config:
  server.labels:
    host: tikv1
</code></pre></div></li>
<li>
<p>PD 配置</p>
<p>PD 需要配置 labels 类型来识别并调度 Region：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">pd:
  replication.location-labels: [<span style="color:#e6db74">"host"</span>]
</code></pre></div></li>
</ul>
</li>
<li>
<p><code>numa_node</code> 绑核</p>
<ul>
<li>
<p>在实例参数模块配置对应的 <code>numa_node</code> 参数，并添加对应的物理 CPU 的核数；</p>
</li>
<li>
<p>numa 绑核使用前，确认已经安装 numactl 工具，以及物理机对应的物理机 CPU 的信息后，再进行参数配置；</p>
</li>
<li>
<p><code>numa_node</code> 这个配置参数与 <code>numactl --membind</code> 配置对应。</p>
</li>
</ul>
</li>
</ul>
<h4 id="heading-4">拓扑信息</h4>
<table>
<thead>
<tr>
<th align="left">实例</th>
<th align="left">个数</th>
<th align="left">物理机配置</th>
<th align="left">IP</th>
<th align="left">配置</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TiKV</td>
<td align="left">6</td>
<td align="left">32 VCore 64GB</td>
<td align="left">10.0.1.1<br/> 10.0.1.2<br/> 10.0.1.3</td>
<td align="left">1. 区分实例级别的 port、status_port；<br/> 2. 配置全局参数 readpool、storage 以及 raftstore 参数；<br/> 3. 配置实例级别 host 维度的 labels；<br/> 4. 配置 numa 绑核操作</td>
</tr>
<tr>
<td align="left">TiDB</td>
<td align="left">6</td>
<td align="left">32 VCore 64GB</td>
<td align="left">10.0.1.7<br/> 10.0.1.8<br/> 10.0.1.9</td>
<td align="left">配置 numa 绑核操作</td>
</tr>
<tr>
<td align="left">PD</td>
<td align="left">3</td>
<td align="left">16 VCore 32 GB</td>
<td align="left">10.0.1.4<br/> 10.0.1.5<br/> 10.0.1.6</td>
<td align="left">配置 location_lables 参数</td>
</tr>
<tr>
<td align="left">TiFlash</td>
<td align="left">1</td>
<td align="left">32 VCore 64 GB</td>
<td align="left">10.0.1.10</td>
<td align="left">默认端口 <br/> 自定义部署目录，配置 data_dir 参数为 <code>/data1/tiflash/data</code></td>
</tr>
</tbody>
</table>
<h4 id="-4--topologyyaml-1">第 4 步：配置文件模版 topology.yaml</h4>
<blockquote>
<p><strong>注意：</strong></p>
<ul>
<li>
<p>配置文件模版时，注意修改必要参数、IP、端口及目录。</p>
</li>
<li>
<p><a href="/docs-cn/stable/reference/tiflash/deploy">部署 TiFlash</a> 需要在 topology.yaml 配置文件中将 <code>replication.enable-placement-rules</code> 设置为 <code>true</code>，以开启 PD 的 <a href="/docs-cn/stable/how-to/configure/placement-rules">Placement Rules</a> 功能。</p>
</li>
<li>
<p>tiflash_servers 实例级别配置 <code>"-host"</code> 目前只支持 IP，不支持域名。</p>
</li>
<li>
<p>TiFlash 具体的参数配置介绍可参考 <a href="#tiflash-%E5%8F%82%E6%95%B0">TiFlash 参数配置</a>。</p>
</li>
</ul>
</blockquote>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat topology.yaml
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># Global variables are applied to all deployments and as the default value of</span>
<span style="color:#75715e"># them if the specific deployment value missing.</span>

global:
  user: <span style="color:#e6db74">"tidb"</span>
  ssh_port: <span style="color:#ae81ff">22</span>
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data"</span>

monitored:
  node_exporter_port: <span style="color:#ae81ff">9100</span>
  blackbox_exporter_port: <span style="color:#ae81ff">9115</span>
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data-monitored-9100"</span>
  log_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100/log"</span>

server_configs:
  tikv:
    readpool.unified.max-thread-count: &lt;取值参考上文计算公式的结果<span style="color:#e6db74">&gt;
</span><span style="color:#e6db74">   </span><span style="color:#e6db74"> </span><span style="color:#e6db74">readpool.storage.use-unified-pool: true</span>
    readpool.coprocessor.use-unified-pool: <span style="color:#66d9ef">true</span>
    storage.block-cache.capacity: <span style="color:#e6db74">"&lt;取值参考上文计算公式的结果&gt;"</span>
    raftstore.capactiy: <span style="color:#e6db74">"&lt;取值参考上文计算公式的结果&gt;"</span>
  pd:
    replication.location-labels: [<span style="color:#e6db74">"host"</span>]
    replication.enable-placement-rules: <span style="color:#66d9ef">true</span>

pd_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.5</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.6</span>

tidb_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
    port: <span style="color:#ae81ff">4000</span>
    status_port: <span style="color:#ae81ff">10080</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
    port: <span style="color:#ae81ff">4001</span>
    status_port: <span style="color:#ae81ff">10081</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.8</span>
    port: <span style="color:#ae81ff">4000</span>
    status_port: <span style="color:#ae81ff">10080</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.8</span>
    port: <span style="color:#ae81ff">4001</span>
    status_port: <span style="color:#ae81ff">10081</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.9</span>
    port: <span style="color:#ae81ff">4000</span>
    status_port: <span style="color:#ae81ff">10080</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4000/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.9</span>
    port: <span style="color:#ae81ff">4001</span>
    status_port: <span style="color:#ae81ff">10081</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tidb-4001/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>

tikv_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.1</span>
    port: <span style="color:#ae81ff">20160</span>
    status_port: <span style="color:#ae81ff">20180</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20160"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
    config:
      server.labels:
        host: tikv1
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.1</span>
    port: <span style="color:#ae81ff">20161</span>
    status_port: <span style="color:#ae81ff">20181</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20161"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>
    config:
      server.labels:
        host: tikv1
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.2</span>
    port: <span style="color:#ae81ff">20160</span>
    status_port: <span style="color:#ae81ff">20180</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20160"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
    config:
      server.labels:
        host: tikv2
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.2</span>
    port: <span style="color:#ae81ff">20161</span>
    status_port: <span style="color:#ae81ff">20181</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20161"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>
    config:
      server.labels:
        host: tikv2
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.3</span>
    port: <span style="color:#ae81ff">20160</span>
    status_port: <span style="color:#ae81ff">20180</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20160"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20160/log"</span>
    numa_node: <span style="color:#e6db74">"0"</span>
    config:
      server.labels:
        host: tikv3
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.3</span>
    port: <span style="color:#ae81ff">20161</span>
    status_port: <span style="color:#ae81ff">20181</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/tikv-20161"</span>
    log_dir: <span style="color:#e6db74">"/tidb-deploy/tikv-20161/log"</span>
    numa_node: <span style="color:#e6db74">"1"</span>
    config:
      server.labels:
        host: tikv3
tiflash_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.10</span>
    data_dir: /data1/tiflash/data
monitoring_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
grafana_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
alertmanager_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
</code></pre></div><h3 id="-3tidb-binlog-">场景 3：TiDB Binlog 部署模版</h3>
<h4 id="heading-5">部署需求</h4>
<p>设置默认部署目录 <code>/tidb-deploy</code> 和 数据目录 <code>/tidb-data</code>，通过 TiDB Binlog 同步到下游机器 10.0.1.9:4000。</p>
<h4 id="heading-6">关键参数</h4>
<p>TiDB 关键参数：</p>
<ul>
<li>
<p><code>binlog.enable: true</code></p>
<p>开启 binlog 服务，默认为 false。</p>
</li>
<li>
<p><code>binlog.ignore-error: true</code></p>
<p>高可用场景建议开启，如果设置为 true，发生错误时，TiDB 会停止写入 binlog，并且在监控项 tidb_server_critical_error_total 上计数加 1；如果设置为 false，一旦写入 binlog 失败，会停止整个 TiDB 的服务。</p>
</li>
</ul>
<h4 id="heading-7">拓扑信息</h4>
<table>
<thead>
<tr>
<th align="left">实例</th>
<th align="left">个数</th>
<th align="left">物理机配置</th>
<th align="left">IP</th>
<th align="left">配置</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TiKV</td>
<td align="left">3</td>
<td align="left">16 VCore 32 GB</td>
<td align="left">10.0.1.1 <br/> 10.0.1.2 <br/> 10.0.1.3</td>
<td align="left">默认端口配置</td>
</tr>
<tr>
<td align="left">TiDB</td>
<td align="left">3</td>
<td align="left">16 VCore 32 GB</td>
<td align="left">10.0.1.7 <br/> 10.0.1.8 <br/> 10.0.1.9</td>
<td align="left">默认端口配置；<br/>开启 enable_binlog； <br/> 开启 ignore-error</td>
</tr>
<tr>
<td align="left">PD</td>
<td align="left">3</td>
<td align="left">4 VCore 8 GB</td>
<td align="left">10.0.1.4 <br/> 10.0.1.5 <br/> 10.0.1.6</td>
<td align="left">默认端口配置</td>
</tr>
<tr>
<td align="left">TiFlash</td>
<td align="left">1</td>
<td align="left">32 VCore 64 GB</td>
<td align="left">10.0.1.10</td>
<td align="left">默认端口 <br/> 自定义部署目录，配置 data_dir 参数为 <code>/data1/tiflash/data,/data2/tiflash/data</code>，进行多盘部署</td>
</tr>
<tr>
<td align="left">Pump</td>
<td align="left">3</td>
<td align="left">8 VCore 16GB</td>
<td align="left">10.0.1.6<br/>10.0.1.7<br/>10.0.1.8</td>
<td align="left">默认端口配置； <br/> 设置 GC 时间 7 天</td>
</tr>
<tr>
<td align="left">Drainer</td>
<td align="left">1</td>
<td align="left">8 VCore 16GB</td>
<td align="left">10.0.1.9</td>
<td align="left">默认端口配置；<br/>设置默认初始化 commitTS</td>
</tr>
</tbody>
</table>
<h4 id="-4--topologyyaml-2">第 4 步：配置文件模版 topology.yaml</h4>
<blockquote>
<p><strong>注意：</strong></p>
<ul>
<li>
<p>配置文件模版时，如无需自定义端口或者目录，仅修改 IP 即可。</p>
</li>
<li>
<p><a href="/docs-cn/stable/reference/tiflash/deploy">部署 TiFlash</a> 需要在 topology.yaml 配置文件中将 <code>replication.enable-placement-rules</code> 设置为 <code>true</code>，以开启 PD 的 <a href="/docs-cn/stable/how-to/configure/placement-rules">Placement Rules</a> 功能。</p>
</li>
<li>
<p>tiflash_servers 实例级别配置 <code>"-host"</code> 目前只支持 ip，不支持域名。</p>
</li>
<li>
<p>TiFlash 具体的参数配置介绍可参考 <a href="#tiflash-%E5%8F%82%E6%95%B0">TiFlash 参数配置</a>。</p>
</li>
</ul>
</blockquote>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat topology.yaml
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># Global variables are applied to all deployments and as the default value of</span>
<span style="color:#75715e"># them if the specific deployment value missing.</span>
global:
  user: <span style="color:#e6db74">"tidb"</span>
  ssh_port: <span style="color:#ae81ff">22</span>
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data"</span>
monitored:
  node_exporter_port: <span style="color:#ae81ff">9122</span>
  blackbox_exporter_port: <span style="color:#ae81ff">9137</span>
  deploy_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100"</span>
  data_dir: <span style="color:#e6db74">"/tidb-data/monitored-9100"</span>
  log_dir: <span style="color:#e6db74">"/tidb-deploy/monitored-9100/log"</span>

server_configs:
  tidb:
    binlog.enable: <span style="color:#66d9ef">true</span>
    binlog.ignore-error: <span style="color:#66d9ef">true</span>
  pd:
    replication.enable-placement-rules: <span style="color:#66d9ef">true</span>

pd_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.5</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.6</span>
tidb_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.8</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.9</span>
tikv_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.1</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.2</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.3</span>

pump_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.6</span>
    ssh_port: <span style="color:#ae81ff">22</span>
    port: <span style="color:#ae81ff">8250</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/pump-8249"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/pump-8249"</span>
    <span style="color:#75715e"># Config is used to overwrite the `server_configs.drainer` values</span>
    config:
      gc: <span style="color:#ae81ff">7</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.7</span>
    ssh_port: <span style="color:#ae81ff">22</span>
    port: <span style="color:#ae81ff">8250</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/pump-8249"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/pump-8249"</span>
    <span style="color:#75715e"># Config is used to overwrite the `server_configs.drainer` values</span>
    config:
      gc: <span style="color:#ae81ff">7</span>
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.8</span>
    ssh_port: <span style="color:#ae81ff">22</span>
    port: <span style="color:#ae81ff">8250</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/pump-8249"</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/pump-8249"</span>
    <span style="color:#75715e"># Config is used to overwrite the `server_configs.drainer` values</span>
    config:
      gc: <span style="color:#ae81ff">7</span>
drainer_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.9</span>
    port: <span style="color:#ae81ff">8249</span>
    data_dir: <span style="color:#e6db74">"/tidb-data/drainer-8249"</span>
    <span style="color:#75715e"># if drainer doesn't have checkpoint, use initial commitTS to initial checkpoint</span>
    <span style="color:#75715e"># will get a latest timestamp from pd if setting to be -1 (default -1)</span>
    commit_ts: -<span style="color:#ae81ff">1</span>
    deploy_dir: <span style="color:#e6db74">"/tidb-deploy/drainer-8249"</span>
    <span style="color:#75715e"># Config is used to overwrite the `server_configs.drainer` values</span>
    config:
      syncer.db-type: <span style="color:#e6db74">"tidb"</span>
      syncer.to.host: <span style="color:#e6db74">"10.0.1.9"</span>
      syncer.to.user: <span style="color:#e6db74">"root"</span>
      syncer.to.password: <span style="color:#e6db74">""</span>
      syncer.to.port: <span style="color:#ae81ff">4000</span>
tiflash_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.10</span>
    data_dir: /data1/tiflash/data,/data2/tiflash/data
monitoring_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
grafana_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
alertmanager_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.4</span>
</code></pre></div><h2 id="3-">3. 执行部署命令</h2>
<h3 id="heading-8">部署命令介绍</h3>
<p>通过 help 查询具体的参数说明：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster  deploy --help
</code></pre></div><p>预期输出结果：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Deploy a cluster for production. SSH connection will be used to deploy files, as well as creating system users for running the service.

Usage:
  cluster deploy &lt;cluster-name&gt; &lt;version&gt; &lt;topology.yaml&gt; [flags]

Flags:
  -h, --help                   help for deploy
  -i, --identity_file string   The path of the SSH identity file. If specified, public key authentication will be used.
      --user string            The user name to login via SSH. The user must has root (or sudo) privilege. (default "root")
  -y, --yes                    Skip confirming the topology

# Usage 展示执行命令样例，&lt;&gt; 为必填项
# Flags 可选参数，有以下的作用：
# 通过 -h 可以查看帮助；
# 通过 -i 执行权限认证；
# --user 通过指定用户来完成 ssh 登录，默认为 root 用户；
# -y 提过拓扑信息确认直接执行部署任务
</code></pre></div><blockquote>
<p><strong>注意：</strong></p>
<p>通过 TiUP 进行集群部署可以使用密钥或者交互密码方式来进行安全认证：</p>
<ul>
<li>如果是密钥方式，可以通过 <code>-i</code> 或者 <code>--identity_file</code> 来指定密钥的路径；</li>
<li>如果是密码方式，无需添加其他参数，<code>Enter</code> 即可进入密码交互窗口。</li>
</ul>
</blockquote>
<h3 id="-5-">第 5 步：执行部署命令</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster deploy tidb-test v4.0.0-beta.2 ./topology.yaml --user root -i /home/root/.ssh/gcp_rsa
</code></pre></div><p>以上部署命令中：</p>
<ul>
<li>通过 TiUP cluster 部署的集群名称为 <code>tidb-test</code></li>
<li>部署版本为 <code>v4.0.0-beta.2</code></li>
<li>初始化配置文件为 <code>topology.yaml</code></li>
<li>通过 root 的密钥登录到目标主机完成集群部署，也可以用其他有 ssh 和 sudo 权限的用户完成部署</li>
</ul>
<p>预期日志输出样例，部署成功会有 <code>Started cluster tidb-test successfully</code> 关键词：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.0.9/cluster deploy tidb-test v4.0.0-beta.2 ./topology.yaml --user root --identity_file /home/root/.ssh/gcp_rsa
Please confirm your topology:
TiDB Cluster: tidb-test
TiDB Version: v4.0.0-beta.2
Type          Host          Ports        Directories
----          ----          -----        -----------
pd            10.0.1.4  2379/2380    /tidb-deploy/pd-2379,/tidb-data/pd-2379
pd            10.0.1.5  2379/2380    /tidb-deploy/pd-2379,/tidb-data/pd-2379
pd            10.0.1.6  2379/2380    /tidb-deploy/pd-2379,/tidb-data/pd-2379
tikv          10.0.1.1  2060/20080   /tidb-deploy/tikv-2060,/tidb-data/tikv-2060
tikv          10.0.1.2  2060/20080   /tidb-deploy/tikv-2060,/tidb-data/tikv-2060
tikv          10.0.1.3  2060/20080   /tidb-deploy/tikv-2060,/tidb-data/tikv-2060
tidb          10.0.1.7  4000/10080   /tidb-deploy/tidb-4000
tidb          10.0.1.8  4000/10080   /tidb-deploy/tidb-4000
tidb          10.0.1.9  4000/10080   /tidb-deploy/tidb-4000
prometheus    10.0.1.4  9090         /tidb-deploy/prometheus-9090,/tidb-data/prometheus-9090
grafana       10.0.1.4  3000         /tidb-deploy/grafana-3000
alertmanager  10.0.1.4  9104/9105    /tidb-deploy/alertmanager-9104,/tidb-data/alertmanager-9104
Attention:
    1. If the topology is not what you expected, check your yaml file.
    2. Please confirm there is no port/directory conflicts in same host.
Do you want to continue? [y/N]:  y
Input SSH password:
+ [ Serial ] - SSHKeyGen: path=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa
+ [Parallel] - Download: component=blackbox_exporter, version=v0.12.0
+ [Parallel] - Download: component=pd, version=v4.0.0-beta.2
+ [Parallel] - Download: component=node_exporter, version=v0.17.0
+ [Parallel] - Download: component=tikv, version=v4.0.0-beta.2
+ [Parallel] - Download: component=tidb, version=v4.0.0-beta.2
+ [Parallel] - Download: component=alertmanager, version=v0.17.0
+ [Parallel] - Download: component=prometheus, version=v2.8.1
+ [Parallel] - Download: component=grafana, version=v6.1.6

...... 部分日志忽略......

Checking service state of pd
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 09:54:22 CST; 50s ago
Checking service state of tikv
    10.0.1.1
           Active: active (running) since Saturday 2020-04-04 09:54:35 CST; 38s ago
    10.0.1.2
           Active: active (running) since Saturday 2020-04-04 09:54:38 CST; 37s ago
    10.0.1.3
           Active: active (running) since Saturday 2020-04-04 09:54:41 CST; 35s ago
Checking service state of tidb
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 09:54:56 CST; 22s ago
Checking service state of prometheus
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 09:55:03 CST; 16s ago
Checking service state of grafana
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 09:55:05 CST; 16s ago
Checking service state of alertmanager
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 09:55:08 CST; 14s ago
Started cluster `tidb-test` successfully
</code></pre></div><h2 id="4-">4. 验证集群部署状态</h2>
<h3 id="heading-9">验证命令介绍</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster list --help
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">List all clusters

Usage:
  cluster list [flags]

Flags:
  -h, --help   help for list

# Usage 展示执行命令，该命令来展示受管理的所有 TiDB 集群的清单。
</code></pre></div><h3 id="-6--tiup-">第 6 步：检查 TiUP 管理集群情况</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster list
</code></pre></div><p>预期输出当前通过 TiUP cluster 管理的集群名称、部署用户、版本、密钥信息等：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster list
Name              User  Version        Path                                                        PrivateKey
----              ----  -------        ----                                                        ----------
tidb-test         tidb  v4.0.0-beta.2  /home/tidb/.tiup/storage/cluster/clusters/tidb-test         /home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa
</code></pre></div><h3 id="-7--tidb-test-">第 7 步：检查 <code>tidb-test</code> 集群情况</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster display tidb-test
</code></pre></div><p>预期输出包括实例 ID、角色、主机、监听端口和状态（为启动，所以状态为 Down/inactive）、目录信息：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster display tidb-test
TiDB Cluster: tidb-test
TiDB Version: v4.0.0-beta.2
ID                  Role          Host          Ports        Status    Data Dir                        Deploy Dir
--                  ----          ----          -----        ------    --------                        ----------
10.0.1.4:9104   alertmanager  10.0.1.4  9104/9105    inactive  /tidb-data/alertmanager-9104  /tidb-deploy/alertmanager-9104
10.0.1.4:3000   grafana       10.0.1.4  3000         inactive  -                             /tidb-deploy/grafana-3000
10.0.1.4:2379   pd            10.0.1.4  2379/2380    Down      /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.5:2379   pd            10.0.1.5  2379/2380    Down      /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.6:2379   pd            10.0.1.6  2379/2380    Down      /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.4:9090   prometheus    10.0.1.4  9090         inactive  /tidb-data/prometheus-9090    /tidb-deploy/prometheus-9090
10.0.1.7:4000   tidb          10.0.1.7  4000/10080   Down      -                             /tidb-deploy/tidb-4000
10.0.1.8:4000   tidb          10.0.1.8  4000/10080   Down      -                             /tidb-deploy/tidb-4000
10.0.1.9:4000   tidb          10.0.1.9  4000/10080   Down      -                             /tidb-deploy/tidb-4000
10.0.1.1:20160  tikv          10.0.1.1  20160/20180  Down      /tidb-data/tikv-20160         /tidb-deploy/tikv-2060
10.0.1.2:20160  tikv          10.0.1.2  20160/20180  Down      /tidb-data/tikv-20160         /tidb-deploy/tikv-2060
10.0.1.3:20160  tikv          10.0.1.4  20160/20180  Down      /tidb-data/tikv-20160         /tidb-deploy/tikv-2060
</code></pre></div><h2 id="5-">5. 启动集群</h2>
<h3 id="-8--tidb-test-">第 8 步：执行 <code>tidb-test</code> 集群启动命令</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster start tidb-test
</code></pre></div><p>预期日志输出样例，结果输出返回 <code>Started cluster tidb-test successfully</code> ，说明启动成功：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster start tidb-test
+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.1
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.2
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [ Serial ] - ClusterOperate: operation=StartOperation, options={Roles:[] Nodes:[] Force:false}
Starting component pd
    Starting instance pd 10.0.1.4:2379
    Start pd 10.0.1.4:2379 success
Starting component node_exporter
    Starting instance 10.0.1.4
    Start 10.0.1.4 success

...... 部分日志忽略......

    Checking service state of pd
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:04 CST; 43s ago
Checking service state of tikv
    10.0.1.1
           Active: active (running) since Saturday 2020-04-04 01:08:15 CST; 33s ago
    10.0.1.2
           Active: active (running) since Saturday 2020-04-04 01:08:18 CST; 31s ago
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:21 CST; 29s ago
Checking service state of tidb
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:36 CST; 16s ago
Checking service state of prometheus
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:39 CST; 15s ago
Checking service state of grafana
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:41 CST; 14s ago
Checking service state of alertmanager
    10.0.1.4
           Active: active (running) since Saturday 2020-04-04 01:08:44 CST; 12s ago
Started cluster `tidb-test` successfully
</code></pre></div><h2 id="6-">6. 验证集群运行状态</h2>
<h3 id="-9--tiup--tidb-test-">第 9 步：通过 TiUP 检查 tidb-test 集群状态</h3>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster display tidb-test
</code></pre></div><p>预期结果输出，注意 Status 状态信息为 <code>Up</code> 说明集群状态正常：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster display tidb-test
TiDB Cluster: tidb-test
TiDB Version: v4.0.0-beta.2
ID                  Role          Host          Ports        Status     Data Dir                        Deploy Dir
--                  ----          ----          -----        ------     --------                        ----------
10.0.1.4:9104   alertmanager  10.0.1.4  9104/9105    Up         /tidb-data/alertmanager-9104  /tidb-deploy/alertmanager-9104
10.0.1.4:3000   grafana       10.0.1.4  3000         Up         -                             /tidb-deploy/grafana-3000
10.0.1.4:2379   pd            10.0.1.4  2379/2380    Healthy|L  /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.5:2379   pd            10.0.1.5  2379/2380    Healthy    /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.6:2379   pd            10.0.1.6  2379/2380    Healthy    /tidb-data/pd-2379            /tidb-deploy/pd-2379
10.0.1.4:9090   prometheus    10.0.1.4  9090         Up         /tidb-data/prometheus-9090    /tidb-deploy/prometheus-9090
10.0.1.7:4000   tidb          10.0.1.7  4000/10080   Up         -                             /tidb-deploy/tidb-4000
10.0.1.8:4000   tidb          10.0.1.8  4000/10080   Up         -                             /tidb-deploy/tidb-4000
10.0.1.9:4000   tidb          10.0.1.9  4000/10080   Up         -                             /tidb-deploy/tidb-4000
10.0.1.1:2060   tikv          10.0.1.1  2060/20080   Up         /tidb-data/tikv-2060          /tidb-deploy/tikv-2060
10.0.1.2:2060   tikv          10.0.1.2  2060/20080   Up         /tidb-data/tikv-2060          /tidb-deploy/tikv-2060
10.0.1.3:2060   tikv          10.0.1.4  2060/20080   Up         /tidb-data/tikv-2060          /tidb-deploy/tikv-2060
</code></pre></div><h3 id="-10--tidb-dashboard--grafana-">第 10 步：通过 TiDB Dashboard 和 Grafana 检查集群状态</h3>
<h4 id="-tidb-dashboard--tidb-cluster-">查看 TiDB Dashboard 检查 TiDB Cluster 状态</h4>
<ul>
<li>
<p>通过 <code>{pd-leader-ip}:2379/dashboard</code> 登录 TiDB Dashboard</p>
<p><img alt="TiDB-Dashboard" class="lazy" data-original="https://download.pingcap.com/images/docs-cn/stable/tiup/tidb-dashboard.png" src="/images/svgs/loader-spinner.svg"/></p>
</li>
<li>
<p>主页面显示 TiDB Cluster 节点信息</p>
<p><img alt="TiDB-Dashboard-status" class="lazy" data-original="https://download.pingcap.com/images/docs-cn/stable/tiup/tidb-dashboard-status.png" src="/images/svgs/loader-spinner.svg"/></p>
</li>
</ul>
<h4 id="-grafana--overview--tidb-cluster-">查看 Grafana 监控 Overview 页面检查 TiDB Cluster 状态</h4>
<ul>
<li>
<p>通过 <code>{Grafana-ip}:3000</code> 登录 Grafana 监控，默认密码为 admin/admin</p>
<p><img alt="Grafana-login" class="lazy" data-original="https://download.pingcap.com/images/docs-cn/stable/tiup/grafana-login.png" src="/images/svgs/loader-spinner.svg"/></p>
</li>
<li>
<p>点击 Overview 监控页面检查 TiDB 端口和负载监控信息</p>
<p><img alt="Grafana-overview" class="lazy" data-original="https://download.pingcap.com/images/docs-cn/stable/tiup/grafana-overview.png" src="/images/svgs/loader-spinner.svg"/></p>
</li>
</ul>
<h3 id="-dmlddl--sql-">登录数据库执行简单 DML、DDL 操作和查询 SQL 语句</h3>
<blockquote>
<p><strong>注意：</strong></p>
<p>登录数据库前，你需要安装 MySQL 客户端。</p>
</blockquote>
<p>执行如下命令登录数据库：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">mysql -u root -h 10.0.1.4 -P <span style="color:#ae81ff">4000</span>
</code></pre></div><p>数据库操作：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 登录成功
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>Welcome <span style="color:#66d9ef">to</span> the MariaDB monitor.  Commands <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">with</span> ; <span style="color:#66d9ef">or</span> <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">g</span>.
Your MySQL <span style="color:#66d9ef">connection</span> id <span style="color:#66d9ef">is</span> <span style="color:#ae81ff">1</span>
Server <span style="color:#66d9ef">version</span>: <span style="color:#ae81ff">5</span>.<span style="color:#ae81ff">7</span>.<span style="color:#ae81ff">25</span><span style="color:#f92672">-</span>TiDB<span style="color:#f92672">-</span>v4.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span><span style="color:#f92672">-</span>beta<span style="color:#f92672">-</span><span style="color:#ae81ff">446</span><span style="color:#f92672">-</span>g5268094af TiDB Server (Apache License <span style="color:#ae81ff">2</span>.<span style="color:#ae81ff">0</span>), MySQL <span style="color:#ae81ff">5</span>.<span style="color:#ae81ff">7</span> compatible

Copyright (<span style="color:#66d9ef">c</span>) <span style="color:#ae81ff">2000</span>, <span style="color:#ae81ff">2018</span>, Oracle, MariaDB Corporation Ab <span style="color:#66d9ef">and</span> others.

<span style="color:#66d9ef">Type</span> <span style="color:#e6db74">'</span><span style="color:#e6db74">help;</span><span style="color:#e6db74">'</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">'</span><span style="color:#e6db74">\h</span><span style="color:#e6db74">'</span> <span style="color:#66d9ef">for</span> help. <span style="color:#66d9ef">Type</span> <span style="color:#e6db74">'</span><span style="color:#e6db74">\c</span><span style="color:#e6db74">'</span> <span style="color:#66d9ef">to</span> clear the <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">input</span> <span style="color:#66d9ef">statement</span>.

<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 检查 TiDB 版本
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [(<span style="color:#66d9ef">none</span>)]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> tidb_version()<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">G</span>
<span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span> <span style="color:#ae81ff">1</span>. <span style="color:#66d9ef">row</span> <span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span>
tidb_version(): Release <span style="color:#66d9ef">Version</span>: v4.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span><span style="color:#f92672">-</span>beta<span style="color:#f92672">-</span><span style="color:#ae81ff">446</span><span style="color:#f92672">-</span>g5268094af
Git <span style="color:#66d9ef">Commit</span> Hash: <span style="color:#ae81ff">5268094</span>afe05c7efef0d91d2deeec428cc85abe6
Git Branch: master
UTC Build Time: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">07</span>
GoVersion: go1.<span style="color:#ae81ff">13</span>
Race Enabled: <span style="color:#66d9ef">false</span>
TiKV <span style="color:#66d9ef">Min</span> <span style="color:#66d9ef">Version</span>: v3.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">60965</span>b006877ca7234adaced7890d7b029ed1306
<span style="color:#66d9ef">Check</span> <span style="color:#66d9ef">Table</span> <span style="color:#66d9ef">Before</span> <span style="color:#66d9ef">Drop</span>: <span style="color:#66d9ef">false</span>
<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
MySQL [tidb]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">database</span> pingcap;
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">10</span> sec)

<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 创建 PingCAP database
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [(<span style="color:#66d9ef">none</span>)]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">database</span> pingcap;
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">10</span> sec)

MySQL [(<span style="color:#66d9ef">none</span>)]<span style="color:#f92672">&gt;</span> use pingcap;
<span style="color:#66d9ef">Database</span> changed
<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 创建 tab_tidb 表
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [pingcap]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>tab_tidb<span style="color:#f92672">`</span> (
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>         <span style="color:#f92672">`</span>id<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> AUTO_INCREMENT,
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>          <span style="color:#f92672">`</span>name<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">20</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#e6db74">'</span><span style="color:#e6db74">'</span>,
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>          <span style="color:#f92672">`</span>age<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#ae81ff">0</span>,
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>          <span style="color:#f92672">`</span><span style="color:#66d9ef">version</span><span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">20</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#e6db74">'</span><span style="color:#e6db74">'</span>,
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>           <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span>),
    <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>           <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>idx_age<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>age<span style="color:#f92672">`</span>));
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">11</span> sec)
<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 插入数据
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [pingcap]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> <span style="color:#f92672">`</span>tab_tidb<span style="color:#f92672">`</span> <span style="color:#66d9ef">values</span> (<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">'</span><span style="color:#e6db74">TiDB</span><span style="color:#e6db74">'</span>,<span style="color:#ae81ff">5</span>,<span style="color:#e6db74">'</span><span style="color:#e6db74">TiDB-v4.0.0</span><span style="color:#e6db74">'</span>);
Query OK, <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">03</span> sec)
<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 查看 tab_tidb 结果
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [pingcap]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> tab_tidb;
<span style="color:#f92672">+</span><span style="color:#75715e">----+------+-----+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> name <span style="color:#f92672">|</span> age <span style="color:#f92672">|</span> <span style="color:#66d9ef">version</span>     <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+------+-----+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> TiDB <span style="color:#f92672">|</span>   <span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span> TiDB<span style="color:#f92672">-</span>v4.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+------+-----+-------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
<span style="color:#75715e">--
</span><span style="color:#75715e"></span><span style="color:#75715e">-- 查看 TiKV store 状态、store_id、存储情况以及启动时间
</span><span style="color:#75715e"></span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>MySQL [pingcap]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> STORE_ID,ADDRESS,STORE_STATE,STORE_STATE_NAME,CAPACITY,AVAILABLE,UPTIME <span style="color:#66d9ef">from</span> INFORMATION_SCHEMA.TIKV_STORE_STATUS;
<span style="color:#f92672">+</span><span style="color:#75715e">----------+--------------------+-------------+------------------+----------+-----------+--------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> STORE_ID <span style="color:#f92672">|</span> ADDRESS            <span style="color:#f92672">|</span> STORE_STATE <span style="color:#f92672">|</span> STORE_STATE_NAME <span style="color:#f92672">|</span> CAPACITY <span style="color:#f92672">|</span> AVAILABLE <span style="color:#f92672">|</span> UPTIME             <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----------+--------------------+-------------+------------------+----------+-----------+--------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>        <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">20160</span> <span style="color:#f92672">|</span>           <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> Up               <span style="color:#f92672">|</span> <span style="color:#ae81ff">49</span>.<span style="color:#ae81ff">98</span>GiB <span style="color:#f92672">|</span> <span style="color:#ae81ff">46</span>.<span style="color:#ae81ff">3</span>GiB   <span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>h21m52.<span style="color:#ae81ff">474864026</span>s <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>        <span style="color:#ae81ff">4</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">20160</span> <span style="color:#f92672">|</span>           <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> Up               <span style="color:#f92672">|</span> <span style="color:#ae81ff">49</span>.<span style="color:#ae81ff">98</span>GiB <span style="color:#f92672">|</span> <span style="color:#ae81ff">46</span>.<span style="color:#ae81ff">32</span>GiB  <span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>h21m52.<span style="color:#ae81ff">522669177</span>s <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>        <span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">20160</span> <span style="color:#f92672">|</span>           <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> Up               <span style="color:#f92672">|</span> <span style="color:#ae81ff">49</span>.<span style="color:#ae81ff">98</span>GiB <span style="color:#f92672">|</span> <span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">44</span>GiB  <span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>h21m52.<span style="color:#ae81ff">713660541</span>s <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----------+--------------------+-------------+------------------+----------+-----------+--------------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)

MySQL [pingcap]<span style="color:#f92672">&gt;</span> exit
Bye
</code></pre></div><h2 id="7-">7. 关闭集群</h2>
<p>执行如下命令关闭 <code>tidb-test</code> 集群：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cluster stop tidb-test
</code></pre></div><p>预期结果输出，注意 <code>Stopped cluster tidb-test successfully</code> 标志关闭成功：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster stop tidb-test
+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.5
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.5
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.2
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.1
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [ Serial ] - ClusterOperate: operation=StopOperation, options={Roles:[] Nodes:[] Force:false}
Stopping component alertmanager
    Stopping instance 10.0.1.4
    Stop alertmanager 10.0.1.4:9104 success

...... 部分日志忽略......

Checking service state of pd
    10.0.1.5
           Active: inactive (dead) since Saturday 2020-04-04 15:35:42 CST; 15s ago
Checking service state of tikv
    10.0.1.1
           Active: inactive (dead) since Saturday 2020-04-04 15:35:21 CST; 38s ago
    10.0.1.2
           Active: inactive (dead) since Saturday 2020-04-04 15:35:23 CST; 37s ago
    10.0.1.3
           Active: inactive (dead) since Saturday 2020-04-04 15:35:24 CST; 37s ago
Checking service state of tidb
    10.0.1.5
           Active: inactive (dead) since Saturday 2020-04-04 15:35:15 CST; 49s ago
Checking service state of prometheus
    10.0.1.4
           Active: inactive (dead) since Saturday 2020-04-04 15:35:12 CST; 53s ago
Checking service state of grafana
    10.0.1.4
           Active: inactive (dead) since Saturday 2020-04-04 15:35:10 CST; 56s ago
Checking service state of alertmanager
    10.0.1.4
           Active: inactive (dead) since Saturday 2020-04-04 15:35:09 CST; 59s ago
Stopped cluster `tidb-test` successfully
</code></pre></div><h2 id="8-">8. 销毁集群</h2>
<blockquote>
<p><strong>警告：</strong></p>
<p><strong>生产环境慎重执行，此操作确认后清理任务无法回退。</strong></p>
</blockquote>
<p>执行如下命令删除 tidb-test 集群，包括数据、服务：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tiup cluster destroy tidb-test
</code></pre></div><p>预期结果输出，注意 <code>Destroy cluster tidb-test successfully</code> 标志销毁成功：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Starting /home/tidb/.tiup/components/cluster/v0.4.3/cluster destroy tidb-test
This operation will destroy TiDB v4.0.0-beta.2 cluster tidb-test and its data.
Do you want to continue? [y/N]: y
Destroying cluster...
+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.2
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.1
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [Parallel] - UserSSH: user=tidb, host=10.0.1.4
+ [ Serial ] - ClusterOperate: operation=StopOperation, options={Roles:[] Nodes:[] Force:false}
Stopping component alertmanager
    Stopping instance 10.0.1.4
    Stop alertmanager 10.0.1.4:9104 success

...... 部分日志忽略......

    Destroy monitored on 10.0.1.1 success
Destroying monitored 10.0.1.2
Destroying monitored
    Destroying instance 10.0.1.2
Destroy monitored on 10.0.1.2 success
Destroying monitored 10.0.1.4
Destroying monitored
    Destroying instance 10.0.1.4
Destroy monitored on 10.0.1.4 success
Destroying component pd
Destroying instance 10.0.1.4
Deleting paths on 10.0.1.4: /tidb-data/pd-2379 /tidb-deploy/pd-2379 /tidb-deploy/pd-2379/log /etc/systemd/system/pd-2379.service
Destroy 10.0.1.4 success
Destroying monitored 10.0.1.4
Destroying monitored
    Destroying instance 10.0.1.4
Destroy monitored on 10.0.1.4 success
Destroyed cluster `tidb-test` successfully
</code></pre></div><h2 id="9-">9. 常见部署问题</h2>
<p>本小节介绍使用 TiUP 部署 TiDB 集群过程中的常见问题与解决方案。</p>
<h3 id="heading-10">默认端口</h3>
<table>
<thead>
<tr>
<th align="left">组件</th>
<th align="left">端口变量</th>
<th align="left">默认端口</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TiDB</td>
<td align="left">port</td>
<td align="left">4000</td>
<td align="left">应用及 DBA 工具访问通信端口</td>
</tr>
<tr>
<td align="left">TiDB</td>
<td align="left">status_port</td>
<td align="left">10080</td>
<td align="left">TiDB 状态信息上报通信端口</td>
</tr>
<tr>
<td align="left">TiKV</td>
<td align="left">port</td>
<td align="left">20160</td>
<td align="left">TiKV 通信端口</td>
</tr>
<tr>
<td align="left">TiKV</td>
<td align="left">status_port</td>
<td align="left">20180</td>
<td align="left">上报 TiKV 状态的通信端口</td>
</tr>
<tr>
<td align="left">PD</td>
<td align="left">client_port</td>
<td align="left">2379</td>
<td align="left">提供 TiDB 和 PD 通信端口</td>
</tr>
<tr>
<td align="left">PD</td>
<td align="left">peer_port</td>
<td align="left">2380</td>
<td align="left">PD 集群节点间通信端口</td>
</tr>
<tr>
<td align="left">Pump</td>
<td align="left">port</td>
<td align="left">8250</td>
<td align="left">Pump 通信端口</td>
</tr>
<tr>
<td align="left">Drainer</td>
<td align="left">port</td>
<td align="left">8249</td>
<td align="left">Drainer 通信端口</td>
</tr>
<tr>
<td align="left">Prometheus</td>
<td align="left">port</td>
<td align="left">9090</td>
<td align="left">Prometheus 服务通信端口</td>
</tr>
<tr>
<td align="left">Node_exporter</td>
<td align="left">node_exporter_port</td>
<td align="left">9100</td>
<td align="left">TiDB 集群每个节点的系统信息上报通信端口</td>
</tr>
<tr>
<td align="left">Blackbox_exporter</td>
<td align="left">blackbox_exporter_port</td>
<td align="left">9115</td>
<td align="left">Blackbox_exporter 通信端口，用于 TiDB 集群端口监控</td>
</tr>
<tr>
<td align="left">Grafana</td>
<td align="left">grafana_port</td>
<td align="left">3000</td>
<td align="left">Web 监控服务对外服务和客户端(浏览器)访问端口</td>
</tr>
<tr>
<td align="left">Alertmanager</td>
<td align="left">web_port</td>
<td align="left">9093</td>
<td align="left">告警 web 服务端口</td>
</tr>
<tr>
<td align="left">Alertmanager</td>
<td align="left">cluster_port</td>
<td align="left">9094</td>
<td align="left">告警通信端口</td>
</tr>
</tbody>
</table>
<h3 id="heading-11">默认目录</h3>
<table>
<thead>
<tr>
<th align="left">模块</th>
<th align="left">目录变量</th>
<th align="left">默认目录</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">global</td>
<td align="left">deploy_dir</td>
<td align="left">/home/tidb/deploy</td>
<td align="left">部署目录</td>
</tr>
<tr>
<td align="left">global</td>
<td align="left">data_dir</td>
<td align="left">/home/tidb/data</td>
<td align="left">数据目录</td>
</tr>
<tr>
<td align="left">global</td>
<td align="left">log_dir</td>
<td align="left">/home/tidb/deploy/log</td>
<td align="left">日志目录</td>
</tr>
<tr>
<td align="left">monitored</td>
<td align="left">deploy_dir</td>
<td align="left">/home/tidb/data</td>
<td align="left">部署目录</td>
</tr>
<tr>
<td align="left">monitored</td>
<td align="left">data_dir</td>
<td align="left">/home/tidb/deploy</td>
<td align="left">数据目录</td>
</tr>
<tr>
<td align="left">monitored</td>
<td align="left">log_dir</td>
<td align="left">/home/tidb/deploy</td>
<td align="left">日志目录</td>
</tr>
<tr>
<td align="left">实例</td>
<td align="left">deploy_dir</td>
<td align="left">继承 global 配置</td>
<td align="left">部署目录</td>
</tr>
<tr>
<td align="left">实例</td>
<td align="left">data_dir</td>
<td align="left">继承 global 配置</td>
<td align="left">数据目录</td>
</tr>
<tr>
<td align="left">实例</td>
<td align="left">log_dir</td>
<td align="left">继承 global 配置</td>
<td align="left">日志目录</td>
</tr>
</tbody>
</table>
<h3 id="tiflash-">TiFlash 参数</h3>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">默认配置</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ssh_port</td>
<td align="left">22</td>
<td align="left">ssh 默认端口</td>
</tr>
<tr>
<td align="left">tcp_port</td>
<td align="left">9000</td>
<td align="left">TiFlash TCP 服务端口</td>
</tr>
<tr>
<td align="left">http_port</td>
<td align="left">8123</td>
<td align="left">TiFlash HTTP 服务端口</td>
</tr>
<tr>
<td align="left">flash_service_port</td>
<td align="left">3930</td>
<td align="left">TiFlash RAFT 服务和 Coprocessor 服务端口</td>
</tr>
<tr>
<td align="left">flash_proxy_port</td>
<td align="left">20170</td>
<td align="left">TiFlash Proxy 服务端口</td>
</tr>
<tr>
<td align="left">flash_proxy_status_port</td>
<td align="left">20292</td>
<td align="left">Prometheus 拉取 TiFlash Proxy metrics 端口</td>
</tr>
<tr>
<td align="left">metrics_port</td>
<td align="left">8234</td>
<td align="left">Prometheus 拉取 TiFlash metrics 端口</td>
</tr>
<tr>
<td align="left">deploy_dir</td>
<td align="left">/home/tidb/deploy/tiflash-9000</td>
<td align="left">TiFlash 部署目录</td>
</tr>
<tr>
<td align="left">data_dir</td>
<td align="left">/home/tidb/deploy/tiflash-9000/data</td>
<td align="left">TiFlash 数据存储目录</td>
</tr>
<tr>
<td align="left">log_dir</td>
<td align="left">/home/tidb/deploy/tiflash-9000/log</td>
<td align="left">TiFlash 日志存储目录</td>
</tr>
</tbody>
</table>
<h3 id="heading-12">参数模块配置（按照从高到低顺序）</h3>
<h4 id="1--1">1. 实例参数模块</h4>
<p>以 TiDB Server 为例，在实例参数模块的配置，即 <code>“- host”</code> 为分割的实例，是最高优先级应用到目标节点的。</p>
<ul>
<li>实例下的 <code>config</code> 配置会优先于 <code>server_configs</code> 参数模块的配置；</li>
<li>实例下的 <code>ssh_port</code>、<code>deploy_dir</code>、<code>log_dir</code> 配置优先 <code>global</code> 参数模块的配置；</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">tidb_servers:
  - host: <span style="color:#ae81ff">10.0</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.11</span>
    ssh_port: <span style="color:#ae81ff">22</span>
    port: <span style="color:#ae81ff">4000</span>
    status_port: <span style="color:#ae81ff">10080</span>
    deploy_dir: <span style="color:#e6db74">"deploy/tidb-4000"</span>
    log_dir: <span style="color:#e6db74">"deploy/tidb-4000/log"</span>
    numa_node: <span style="color:#e6db74">"0,1"</span>
    <span style="color:#75715e"># Config is used to overwrite the `server_configs.tidb` values</span>
    config:
      log.level: warn
      log.slow-query-file: tidb-slow-overwritten.log
</code></pre></div><h4 id="2-globalserver-configsmonitored-">2. <code>global</code>、<code>server_configs</code>、<code>monitored</code> 参数模块</h4>
<ul>
<li>
<p><code>global</code> 参数模块的配置为全局配置，优先级低于实例参数模块的配置。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">global:
user: <span style="color:#e6db74">"tidb"</span>
ssh_port: <span style="color:#ae81ff">22</span>
deploy_dir: <span style="color:#e6db74">"deploy"</span>
data_dir: <span style="color:#e6db74">"data"</span>
</code></pre></div></li>
<li>
<p><code>server_configs</code> 参数模块的配置应用于全局监控配置，优先级低于实例参数模块的配置。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">server_configs:
tidb:
    binlog.enable: <span style="color:#66d9ef">false</span>
    binlog.ignore-error: <span style="color:#66d9ef">false</span>
tikv:
    readpool.storage.low-concurrency: <span style="color:#ae81ff">8</span>
    server.labels:
    zone: sh
    dc: sha
    rack: rack1
    host: host1
pd:
    replication.enable-placement-rules: <span style="color:#66d9ef">true</span>
    label-property:
    reject-leader:
        - key: <span style="color:#e6db74">"dc"</span>
        value: <span style="color:#e6db74">"bja"</span>
pump:
    gc: <span style="color:#ae81ff">7</span>
</code></pre></div></li>
<li>
<p><code>monitored</code> 参数模块应用于被监控的主机，默认端口为 9100 和 9115，目录如果配置，默认会部署在用户的 <code>/home</code> 目录下，例如 <code>global</code> 参数模块配置的 <code>user</code> 为 tidb 用户，默认会配置到 <code>/home/tidb</code> 目录下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">monitored:
node_exporter_port: <span style="color:#ae81ff">9100</span>
blackbox_exporter_port: <span style="color:#ae81ff">9115</span>
deploy_dir: <span style="color:#e6db74">"deploy/monitored-9100"</span>
data_dir: <span style="color:#e6db74">"data/monitored-9100"</span>
log_dir: <span style="color:#e6db74">"deploy/monitored-9100/log"</span>
</code></pre></div></li>
</ul>
<h3 id="-ntp-">检测 NTP 服务是否正常</h3>
<ol>
<li>
<p>执行以下命令，如果输出 <code>running</code> 表示 NTP 服务正在运行：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl status ntpd.service
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ntpd.service - Network Time Service
Loaded: loaded (/usr/lib/systemd/system/ntpd.service; disabled; vendor preset: disabled)
Active: active (running) since 一 2017-12-18 13:13:19 CST; 3s ago
</code></pre></div></li>
<li>
<p>执行 <code>ntpstat</code> 命令，如果输出 <code>synchronised to NTP server</code>（正在与 NTP server 同步），表示在正常同步：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ntpstat
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">synchronised to NTP server (85.199.214.101) at stratum 2
time correct to within 91 ms
polling server every 1024 s
</code></pre></div><blockquote>
<p><strong>注意：</strong></p>
<p>Ubuntu 系统需安装 <code>ntpstat</code> 软件包。</p>
</blockquote>
</li>
</ol>
<ul>
<li>
<p>以下情况表示 NTP 服务未正常同步：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ntpstat
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">unsynchronised
</code></pre></div></li>
<li>
<p>以下情况表示 NTP 服务未正常运行：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ntpstat
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Unable to talk to NTP daemon. Is it running?
</code></pre></div></li>
<li>
<p>如果要使 NTP 服务尽快开始同步，执行以下命令。可以将 <code>pool.ntp.org</code> 替换为你的 NTP server：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl stop ntpd.service <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sudo ntpdate pool.ntp.org <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sudo systemctl start ntpd.service
</code></pre></div></li>
<li>
<p>如果要在 CentOS 7 系统上手动安装 NTP 服务，可执行以下命令：</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo yum install ntp ntpdate <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sudo systemctl start ntpd.service <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sudo systemctl enable ntpd.service
</code></pre></div></li>
</ul>
<h3 id="-ssh--sudo-">如何手动配置 SSH 互信及 sudo 免密码</h3>
<ol>
<li>
<p>以 <code>root</code> 用户依次登录到部署目标机器创建 <code>tidb</code> 用户并设置登录密码。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">useradd tidb <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>passwd tidb
</code></pre></div></li>
<li>
<p>执行以下命令，将 <code>tidb ALL=(ALL) NOPASSWD: ALL</code> 添加到文件末尾，即配置好 sudo 免密码。</p>
<div class="copyable-code-block shell-root">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">visudo
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">tidb ALL=(ALL) NOPASSWD: ALL
</code></pre></div></li>
<li>
<p>以 <code>tidb</code> 用户登录到中控机，执行以下命令。将 <code>10.0.1.1</code> 替换成你的部署目标机器 IP，按提示输入部署目标机器 <code>tidb</code> 用户密码，执行成功后即创建好 SSH 互信，其他机器同理。</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh-copy-id -i ~/.ssh/id_rsa.pub 10.0.1.1
</code></pre></div></li>
<li>
<p>以 <code>tidb</code> 用户登录中控机，通过 <code>ssh</code> 的方式登录目标机器 IP。如果不需要输入密码并登录成功，即表示 SSH 互信配置成功。</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh 10.0.1.1
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[tidb@10.0.1.1 ~]$
</code></pre></div></li>
<li>
<p>以 <code>tidb</code> 用户登录到部署目标机器后，执行以下命令，不需要输入密码并切换到 <code>root</code> 用户，表示 <code>tidb</code> 用户 sudo 免密码配置成功。</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -su root
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[root@10.0.1.1 tidb]#
</code></pre></div></li>
</ol>
<h3 id="heading-13">关闭部署机器的防火墙</h3>
<ol>
<li>
<p>检查防火墙状态（以 CentOS Linux release 7.7.1908 (Core) 为例）</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo firewall-cmd --state
sudo systemctl status firewalld.service
</code></pre></div></li>
<li>
<p>关闭防火墙服务</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl stop firewalld.service
</code></pre></div></li>
<li>
<p>关闭防火墙自动启动服务</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl disable firewalld.service
</code></pre></div></li>
<li>
<p>检查防火墙状态</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl status firewalld.service
</code></pre></div></li>
</ol>
<h3 id="-numactl-">安装 numactl 工具</h3>
<blockquote>
<p><strong>注意：</strong></p>
<ul>
<li>numa 绑核是用来隔离 CPU 资源一种方法，适合高配置物理机环境部署多实例使用。</li>
<li>通过 <code>tiup cluster deploy</code> 完成部署操作，就可以通过 <code>exec</code> 命令来进行集群级别管理工作。</li>
</ul>
</blockquote>
<ol>
<li>
<p>登录到目标节点进行安装（以 CentOS Linux release 7.7.1908 (Core) 为例）</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo yum -y install numactl
</code></pre></div></li>
<li>
<p>通过 TiUP 的 cluster 执行完 exec 命令来完成批量安装</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tiup cluster exec --help
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Run shell command on host in the tidb cluster

Usage:
cluster exec &lt;cluster-name&gt; [flags]

Flags:
    --command string   the command run on cluster host (default "ls")
-h, --help             help for exec
    --sudo             use root permissions (default false)
</code></pre></div><p>操作命令，将 tidb-test 集群所有目标主机通过 sudo 权限执行安装命令</p>
<div class="copyable-code-block shell-regular">
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tiup cluster exec tidb-test --sudo --command <span style="color:#e6db74">"yum -y install numactl"</span>
</code></pre></div></li>
</ol>
</div>
<div class="article-toc"></div>
<div class="git-info">
<a class="link" href="https://github.com/pingcap/docs-cn/blob/release-4.0/how-to/deploy/orchestrated/tiup.md">"使用 TiUP 部署 TiDB 集群"</a>
    更新于
    <span>Apr 9 2020</span>:
    <a class="link" href="https://github.com/pingcap/docs-cn/commit/221f1936a58f67501d150e957202c2826fc22a24">
        how-to/deploy: refine title format (#2675) (#2676) <span class="hash">(221f193)</span>
</a>
</div></div>
<div class="sidebar-page sticky-sidebar">
<a class="improve-doc" href="https://github.com/pingcap/docs-cn/edit/release-4.0/how-to/deploy/orchestrated/tiup.md" target="_blank">
<svg fill="#142848" height="14" viewbox="0 0 275.836 275.836" width="14" xmlns="http://www.w3.org/2000/svg"><path d="M191.344 20.922l-95.155 95.155a5.99 5.99 0 0 0-1.565 2.734l-8.167 31.454a6.003 6.003 0 0 0 7.315 7.316l31.454-8.168a6.003 6.003 0 0 0 2.734-1.565l95.153-95.153.005-.004.004-.005 19.156-19.156a5.998 5.998 0 0 0 .001-8.484L218.994 1.758a5.998 5.998 0 0 0-8.485 0l-19.155 19.155-.005.004-.005.005zm-70.713 117.286l-19.993 5.192 5.191-19.993 89.762-89.762 14.801 14.802-89.761 89.761zm94.12-123.723l14.801 14.802-10.675 10.675-14.801-14.802 10.675-10.675z"></path><path d="M238.037 65.022a6 6 0 0 0-6 6v192.813H43.799V34.417h111.063a6 6 0 0 0 0-12H37.799a6 6 0 0 0-6 6v241.419a6 6 0 0 0 6 6h200.238a6 6 0 0 0 6-6V71.022a6 6 0 0 0-6-6z"></path></svg>
    修改本文
</a>
<a class="request-docs-changes" href="https://github.com/pingcap/docs-cn/issues/new?body=File:%20[%2fhow-to%2fdeploy%2forchestrated%2ftiup.md](https%3a%2f%2fpingcap.com%2fdocs-cn%2fv4.0%2fhow-to%2fdeploy%2forchestrated%2ftiup%2f)" target="_blank">
<svg height="14px" version="1.1" viewbox="0 0 192 192" width="14px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g fill="none" fill-rule="nonzero" font-family="none" font-size="none" font-weight="none" stroke="none" stroke-dasharray="" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-width="1" style="mix-blend-mode: normal" text-anchor="none"><path d="M0,192v-192h192v192z" fill="none"></path><g fill="#142848"><path d="M162.34375,42.34375l-90.34375,90.34375l-34.34375,-34.34375l-11.3125,11.3125l45.65625,45.65625l101.65625,-101.65625z"></path></g></g></svg>

    反馈文档问题
</a>
<p class="toc-title">本页导航</p>
<div id="smart_toc_wrapper"></div>
<div class="live-poster-pc"><img class="lazy" src="/images/live-poster-pc.jpg"/></div>
</div>
</div>
</div>
<footer>
<div class="container">
<div class="flex-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>产品</strong></h4>
<ul>
<li><a href="/docs-cn/v3.0/" onclick="trackViews('footer-product-tidb', 'docs-cn_view')">TiDB</a></li>
<li><a href="/docs-cn/v3.0/reference/tispark/">TiSpark</a></li>
<li><a href="/docs-cn/v3.0/roadmap/">TiDB 路线图</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>文档</strong></h4>
<ul>
<li><a href="/docs-cn/stable/how-to/get-started/deploy-tidb-from-docker-compose/">快速入门</a></li>
<li><a href="/blog-cn/tidb-best-practice/">最佳实践</a></li>
<li><a href="/docs-cn/stable/faq/tidb/">常见问题解答</a></li>
<li><a href="/docs-cn/stable/reference/tools/user-guide/">TiDB 周边工具</a></li>
<li><a href="/docs-cn/dev/releases/rn/">版本发布说明</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>资源</strong></h4>
<ul>
<li><a href="/blog-cn/">博客</a></li>
<li><a href="https://github.com/pingcap" target="_blank">GitHub</a></li>
<li><a href="https://book.tidb.io" target="_blank">TiDB in Action</a></li>
<li><a href="https://university.pingcap.com/" onclick="trackViews('footer-source-university', 'pingcap-university_view')" target="_blank">PingCAP
                    University</a></li>
<li><a href="/solutions/intel/" onclick="trackViews('footer-resource-solutions', 'solutions_view')">联合解决方案</a></li>
<li><a href="https://asktug.com/" onclick="trackViews('footer-resource-asktug', 'asktug_view')" target="_blank">Ask TUG</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>公司</strong></h4>
<ul>
<li><a href="/about-cn/">关于我们</a></li>
<li><a href="/about-cn/recruit/join/" onclick="trackViews('footer-recruit-join', 'recruit-join_view')">招贤纳士</a>
</li>
<li><a href="/about-cn/news/">新闻报道</a></li>
</ul>
</div>
</div>
<div class="contact-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>联系我们</strong></h4>
<ul>
<li><a class="twitter" href="https://twitter.com/PingCAP" target="_blank"><svg height="19" viewbox="0 0 612 612" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M612 116.258a250.714 250.714 0 0 1-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 0 1-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg> Twitter</a></li>
<li><a class="linkedin" href="https://www.linkedin.com/company/pingcap/" target="_blank"><svg height="16" viewbox="0 0 438.536 438.535" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M5.424 145.895H99.64v282.932H5.424zM408.842 171.739c-19.791-21.604-45.967-32.408-78.512-32.408-11.991 0-22.891 1.475-32.695 4.427-9.801 2.95-18.079 7.089-24.838 12.419-6.755 5.33-12.135 10.278-16.129 14.844-3.798 4.337-7.512 9.389-11.136 15.104v-40.232h-93.935l.288 13.706c.193 9.139.288 37.307.288 84.508 0 47.205-.19 108.777-.572 184.722h93.931V270.942c0-9.705 1.041-17.412 3.139-23.127 4-9.712 10.037-17.843 18.131-24.407 8.093-6.572 18.13-9.855 30.125-9.855 16.364 0 28.407 5.662 36.117 16.987 7.707 11.324 11.561 26.98 11.561 46.966V428.82h93.931V266.664c-.007-41.688-9.897-73.328-29.694-94.925zM53.103 9.708c-15.796 0-28.595 4.619-38.4 13.848C4.899 32.787 0 44.441 0 58.529 0 72.42 4.758 84.034 14.275 93.358c9.514 9.325 22.078 13.99 37.685 13.99h.571c15.99 0 28.887-4.661 38.688-13.99 9.801-9.324 14.606-20.934 14.417-34.829-.19-14.087-5.047-25.742-14.561-34.973C81.562 14.323 68.9 9.708 53.103 9.708z"></path></svg> LinkedIn</a></li>
<li><a class="reddit" href="https://www.reddit.com/r/TiDB/" target="_blank"><svg height="18" viewbox="0 0 279.748 279.748" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M279.748 133.142c0-19.299-15.701-35-35-35-10.768 0-20.674 4.812-27.279 13.064-18.532-8.431-39.663-13.626-62.015-15.271l19.206-60.692 42.895 9.294c3.285 12.782 14.901 22.258 28.693 22.258 16.336 0 29.627-13.29 29.627-29.626 0-16.336-13.291-29.627-29.627-29.627-11.801 0-21.999 6.941-26.759 16.95l-49.497-10.725a10.002 10.002 0 0 0-11.651 6.756L134.636 95.43c-26.164.638-50.988 6.053-72.356 15.775-6.606-8.251-16.512-13.063-27.28-13.063-19.299 0-35 15.701-35 35 0 9.373 3.683 18.173 10.222 24.709-3.9 8.37-5.875 17.076-5.875 25.936 0 24.048 14.396 46.492 40.538 63.199 25.447 16.264 59.183 25.221 94.989 25.221 35.808 0 69.542-8.957 94.989-25.221 26.142-16.707 40.538-39.151 40.538-63.199 0-8.859-1.975-17.565-5.875-25.936 6.539-6.537 10.222-15.336 10.222-24.709zM15.369 145.139c-2.212-3.59-3.369-7.688-3.369-11.997 0-12.682 10.317-23 23-23 5.444 0 10.558 1.851 14.649 5.258-14.622 8.302-26.132 18.289-34.28 29.739zm52.671 20.266c0-13.785 11.215-25 25-25s25 11.215 25 25-11.215 25-25 25-25-11.215-25-25zm123.119 57.054c-9.745 10.637-29.396 17.244-51.285 17.244-21.888 0-41.539-6.607-51.284-17.244a9.937 9.937 0 0 1-2.617-7.192 9.933 9.933 0 0 1 3.235-6.937 9.974 9.974 0 0 1 6.754-2.627c2.797 0 5.484 1.183 7.373 3.244 5.803 6.333 20.827 10.756 36.539 10.756s30.737-4.423 36.539-10.756a10.022 10.022 0 0 1 7.374-3.244c2.508 0 4.906.933 6.755 2.627a9.928 9.928 0 0 1 3.234 6.937 9.933 9.933 0 0 1-2.617 7.192zm-4.451-32.054c-13.785 0-25-11.215-25-25s11.215-25 25-25 25 11.215 25 25-11.215 25-25 25zm77.671-45.266c-8.147-11.45-19.657-21.436-34.28-29.739 4.092-3.408 9.205-5.258 14.649-5.258 12.683 0 23 10.318 23 23 0 4.309-1.157 8.407-3.369 11.997z"></path></svg> Reddit</a></li>
<li><a class="google-plus" href="https://groups.google.com/forum/#!forum/tidb-user" target="_blank"><svg height="20" viewbox="0 0 491.858 491.858" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M377.472 224.957H201.319v58.718H308.79c-16.032 51.048-63.714 88.077-120.055 88.077-69.492 0-125.823-56.335-125.823-125.824 0-69.492 56.333-125.823 125.823-125.823 34.994 0 66.645 14.289 89.452 37.346l42.622-46.328c-34.04-33.355-80.65-53.929-132.074-53.929C84.5 57.193 0 141.693 0 245.928s84.5 188.737 188.736 188.737c91.307 0 171.248-64.844 188.737-150.989v-58.718l-.001-.001zM491.858 224.857h-36.031v-36.031h-30.886v36.031H388.91v30.883h36.031v36.032h30.886V255.74h36.031z"></path></svg> Google Group</a></li>
<li><a class="stack-overflow" href="https://stackoverflow.com/questions/tagged/tidb" target="_blank"><svg height="17" viewbox="0 0 547.597 547.597" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M140.81 475.111h.024l189.91-.269c8.434-.013 15.3-6.886 15.3-15.318v-21.298c0-8.428-6.854-15.288-15.3-15.288l-189.91.264c-8.433.012-15.3 6.885-15.3 15.318v21.31c.001 8.427 6.855 15.281 15.276 15.281z"></path><path d="M58.667 517.854c.073 29.26.073 29.449 3.072 29.449h.055l10.612.294h.086s85.814 0 171.629-.036c42.914-.019 85.821-.05 118-.092 16.09-.019 29.505-.043 38.887-.074 17.803-.055 17.803-.055 17.803-3.072l.3-10.697V333.299c0-8.434-6.866-15.3-15.3-15.3h-11.909c-8.434 0-15.3 6.866-15.3 15.3V496.22c0 5.062-4.119 9.18-9.181 9.18H110.51c-5.061 0-9.18-4.118-9.18-9.18V333.299c0-8.434-6.867-15.3-15.3-15.3H73.82c-8.433 0-15.3 6.86-15.3 15.3 0 23.342.012 76.084.055 122.981.019 23.447.05 45.442.092 61.574z"></path><path d="M142.322 397.399l189.402 17.467c.478.043.948.062 1.413.062 7.956 0 14.468-5.985 15.159-13.917l1.83-21.096c.729-8.396-5.508-15.851-13.898-16.628l-189.102-17.461c-8.593-.795-15.869 5.441-16.653 13.825l-1.97 21.108a15.172 15.172 0 0 0 3.452 11.181 15.19 15.19 0 0 0 10.367 5.459zM437.636 208.849a15.253 15.253 0 0 0 17.694 12.443l21.065-3.678c8.311-1.451 13.898-9.395 12.454-17.706l-32.504-187.23c-1.42-8.207-9.21-13.917-17.692-12.448l-21.065 3.678c-8.311 1.451-13.898 9.395-12.454 17.705l32.502 187.236zM190.333 194.375l163.6 96.708a15.28 15.28 0 0 0 7.778 2.136c5.393 0 10.447-2.876 13.183-7.509l10.876-18.36c2.08-3.519 2.674-7.631 1.658-11.591a15.18 15.18 0 0 0-7.032-9.358l-163.6-96.714c-7.014-4.149-16.836-1.597-20.967 5.374l-10.869 18.36a15.2 15.2 0 0 0-1.658 11.591 15.21 15.21 0 0 0 7.031 9.363zM387.525 240.501a15.276 15.276 0 0 0 12.626 6.659c3.091 0 6.077-.924 8.635-2.681l17.405-11.934c6.953-4.768 8.752-14.314 4.015-21.292L323.29 54.104c-4.584-6.732-14.498-8.623-21.236-3.984l-17.737 12.21c-6.945 4.779-8.727 14.327-3.971 21.291l107.179 156.88zM154.482 302.319l183.465 49.156c1.298.349 2.632.526 3.966.526 6.903 0 12.98-4.67 14.762-11.347l5.508-20.624c2.179-8.152-2.681-16.555-10.826-18.74l-183.465-49.162c-8.017-2.148-16.604 2.852-18.728 10.826l-5.508 20.63c-2.179 8.142 2.68 16.551 10.826 18.735z"></path></svg> Stack Overflow</a></li>
<li id="wechat"><a class="wechat" href="javascript:void(0)"><svg height="17" viewbox="0 0 31.403 31.404" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M31.403 21.306c0-4.597-4.388-8.32-9.8-8.32-5.414 0-9.802 3.725-9.802 8.32 0 4.597 4.388 8.322 9.802 8.322 1.701 0 3.302-.369 4.697-1.019l3.863 1.671-.447-4.309c1.066-1.329 1.687-2.937 1.687-4.665zm-13.102-2.254a1.395 1.395 0 1 1 0-2.79 1.395 1.395 0 0 1 0 2.79zm6.604 0a1.395 1.395 0 1 1 .003-2.79 1.395 1.395 0 0 1-.003 2.79z"></path><path d="M21.604 11.885c1.515 0 2.957.27 4.271.755.009-.175.03-.345.03-.521 0-6.074-5.801-10.996-12.953-10.996C5.799 1.123 0 6.044 0 12.119c0 2.284.822 4.408 2.229 6.167l-.591 5.694 5.104-2.213c1.264.59 2.661.986 4.136 1.189a8.143 8.143 0 0 1-.179-1.65c.001-5.195 4.892-9.421 10.905-9.421zm-4.287-6.428a1.84 1.84 0 1 1-1.841 1.84c0-1.016.825-1.84 1.841-1.84zM8.586 9.139a1.84 1.84 0 0 1 0-3.682 1.84 1.84 0 1 1 0 3.682z"></path></svg> 微信公众号</a> <div class="qr_code_outer f-hide f-tc">
<div class="qr_code">
<i id="close_qrcode"><svg viewbox="0 0 224.512 224.512" xmlns="http://www.w3.org/2000/svg"><path d="M224.507 6.997L217.521 0 112.256 105.258 6.998 0 .005 6.997l105.258 105.257L.005 217.512l6.993 7L112.256 119.24l105.265 105.272 6.986-7-105.258-105.258z" fill="#010002"></path></svg></i>
<img alt="Wechat qrCode" class="qr_code_img" id="js_qr_code_img" src="/images/wechat-qrcode.jpg"/>
<p>微信扫一扫<br/> 微信ID：pingcap2015</p>
</div>
</div>
</li>
</ul>
</div>
<div class="subscribe" id="subscribe-pc"></div>
</div>
</div>
<div class="container copyright-container">
<p class="copyright">© 2020 北京平凯星辰科技发展有限公司</p>
<a class="copyright-btn-lang copyright-btn-en" href="/docs/stable" id="lang">English</a>
<a class="prepared-num" href="http://www.beian.miit.gov.cn/">京 ICP 备 16046278 号 - 2</a>
</div>
</footer>
<button class="back-to-top" type="button"><svg height="512" viewbox="0 0 284.929 284.929" width="512" xmlns="http://www.w3.org/2000/svg"><path d="M282.082 195.285L149.028 62.24c-1.901-1.903-4.088-2.856-6.562-2.856s-4.665.953-6.567 2.856L2.856 195.285C.95 197.191 0 199.378 0 201.853c0 2.474.953 4.664 2.856 6.566l14.272 14.271c1.903 1.903 4.093 2.854 6.567 2.854s4.664-.951 6.567-2.854l112.204-112.202 112.208 112.209c1.902 1.903 4.093 2.848 6.563 2.848 2.478 0 4.668-.951 6.57-2.848l14.274-14.277c1.902-1.902 2.847-4.093 2.847-6.566.001-2.476-.944-4.666-2.846-6.569z" fill="#FFF"></path></svg>
</button>
</div><div class="overlay"></div><script src="https://download.pingcap.com/js/jquery.min.js"></script><script src="/js/vendor/lazyload.min.js" type="text/javascript"></script>
<script src="/js/doc.js" type="text/javascript"></script>
<script src="/js/anchor.js" type="text/javascript"></script><script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script crossorigin="anonymous" integrity="sha384-jbFinqIbKkHNg+QL+yxB4VrBC0EAPTuaLGeRT0T+NfEV89YC6u1bKxHLwoo+/xxY" src="https://browser.sentry-cdn.com/5.11.0/bundle.min.js"></script><script>Sentry.init({ 
            dsn: 'https://3f28ed393c5545daa74496b3cdb2e9ba@sentry.io/1887163' 
        });</script><script src="/js/app.js"></script></body></html>